{"ast":null,"code":"var _jsxFileName = \"/Users/faybennett/outlierTasks/game-app/src/App.tsx\",\n  _s = $RefreshSig$();\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\n\n// Types\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n// Constants\nconst SAVE_KEY = \"apocalypse-idle-save\";\nconst AUTO_SAVE_INTERVAL = 10000; // 10 seconds\nconst DISASTER_CHANCE = 0.002; // 0.2% chance per second\n\nconst initialResources = {\n  food: 100,\n  water: 100,\n  materials: 50,\n  survivors: 5\n};\nconst disasters = [{\n  id: \"raiders\",\n  name: \"Raider Attack!\",\n  description: \"Raiders have attacked your base!\",\n  effect: {\n    food: -20,\n    water: -15,\n    materials: -10\n  }\n}, {\n  id: \"drought\",\n  name: \"Drought\",\n  description: \"Water supplies are running low!\",\n  effect: {\n    water: -30\n  }\n}, {\n  id: \"sickness\",\n  name: \"Disease Outbreak\",\n  description: \"A disease has spread through your camp!\",\n  effect: {\n    survivors: -1,\n    food: -10\n  }\n}];\nconst ApocalypticGame = () => {\n  _s();\n  // State\n  const [resources, setResources] = useState(initialResources);\n  const [activeTab, setActiveTab] = useState(\"resources\");\n  const [isMobile, setIsMobile] = useState(false);\n  const [showRadialMenu, setShowRadialMenu] = useState(false);\n  const [radialMenuPosition, setRadialMenuPosition] = useState({\n    x: 0,\n    y: 0\n  });\n  const [selectedLocation, setSelectedLocation] = useState(null);\n  const [showDisaster, setShowDisaster] = useState(null);\n  const [autoScavengeEnabled, setAutoScavengeEnabled] = useState(true);\n  const [scavengeResult, setScavengeResult] = useState(null);\n  const [showAttackResult, setShowAttackResult] = useState(null);\n  const [waitingForScavengePopup, setWaitingForScavengePopup] = useState(false);\n  const gameLoopRef = useRef(null);\n  const autoSaveRef = useRef(null);\n  const [upgrades, setUpgrades] = useState([{\n    id: \"farm\",\n    name: \"Makeshift Farm\",\n    description: \"Produces food over time\",\n    cost: {\n      materials: 50\n    },\n    effect: \"+2 food/minute\",\n    level: 0,\n    maxLevel: 5\n  }, {\n    id: \"well\",\n    name: \"Water Collector\",\n    description: \"Collects water from the atmosphere\",\n    cost: {\n      materials: 40\n    },\n    effect: \"+1 water/minute\",\n    level: 0,\n    maxLevel: 5\n  }, {\n    id: \"shelter\",\n    name: \"Survivor Shelter\",\n    description: \"Attracts new survivors\",\n    cost: {\n      materials: 100,\n      food: 50\n    },\n    effect: \"+1 survivor chance/hour\",\n    level: 0,\n    maxLevel: 3\n  }]);\n  const GRID_SIZE = 5;\n  const locationNames = [\"Dustfield\", \"Ashrock\", \"Ironpit\", \"Deadwell\", \"Cragpoint\", \"Burnpass\", \"Mudspire\", \"Wretchend\", \"Redhollow\", \"Saltmoor\", \"Scraptown\", \"Charcliff\", \"Dryreach\", \"Ragbank\", \"Blightden\", \"Boneplain\", \"Rustbarrow\", \"Smokefall\", \"Shivglen\", \"Flintgorge\", \"Gravefen\", \"Scorchbay\", \"Fogscar\", \"Ruinstep\", \"Crimsonlot\"];\n  const generateInitialGrid = () => {\n    const locations = [];\n    for (let y = 0; y < GRID_SIZE; y++) {\n      for (let x = 0; x < GRID_SIZE; x++) {\n        const isBase = x === Math.floor(GRID_SIZE / 2) && y === Math.floor(GRID_SIZE / 2);\n        locations.push({\n          id: `cell-${x}-${y}`,\n          name: isBase ? \"Your Base\" : locationNames[y * GRID_SIZE + x] || `Sector-${x}-${y}`,\n          isBase: isBase,\n          x,\n          y,\n          discovered: isBase,\n          scavengeTime: isBase ? 0 : 5000 + Math.floor(Math.random() * 5000),\n          lastScavenged: null,\n          resources: isBase ? {} : Math.random() < 0.6 // change of having resoureces on newly discovered locations\n          ? {\n            food: Math.floor(Math.random() * 30),\n            water: Math.floor(Math.random() * 20),\n            materials: Math.random() < 0.5 ? Math.floor(Math.random() * 40) : 0,\n            survivors: Math.random() < 0.2 ? 1 : 0\n          } : {},\n          owner: isBase ? \"player\" : null // Set owner for base and null for others\n        });\n      }\n    }\n    return locations;\n  };\n  const [locations, setLocations] = useState(generateInitialGrid());\n  const resourcesRef = useRef(resources);\n  const upgradesRef = useRef(upgrades);\n\n  // Update refs whenever state changes\n  useEffect(() => {\n    resourcesRef.current = resources;\n  }, [resources]);\n  useEffect(() => {\n    upgradesRef.current = upgrades;\n  }, [upgrades]);\n\n  // Responsive design\n  useEffect(() => {\n    const checkMobile = () => {\n      setIsMobile(window.innerWidth < 768);\n    };\n    checkMobile();\n    window.addEventListener(\"resize\", checkMobile);\n    return () => window.removeEventListener(\"resize\", checkMobile);\n  }, []);\n\n  // Load game\n  useEffect(() => {\n    const savedGame = localStorage.getItem(SAVE_KEY);\n    if (savedGame) {\n      try {\n        const gameState = JSON.parse(savedGame);\n        const timePassed = Date.now() - gameState.lastSave;\n\n        // Calculate offline progression\n        const minutesPassed = timePassed / 60000;\n        const offlineResources = {\n          ...gameState.resources\n        };\n        gameState.upgrades.forEach(upgrade => {\n          if (upgrade.id === \"farm\" && upgrade.level > 0) {\n            offlineResources.food += Math.floor(minutesPassed * 2 * upgrade.level * 0.5); // 50% efficiency offline\n          }\n          if (upgrade.id === \"well\" && upgrade.level > 0) {\n            offlineResources.water += Math.floor(minutesPassed * 1 * upgrade.level * 0.5);\n          }\n          if (upgrade.id === \"shelter\" && upgrade.level > 0) {\n            offlineResources.survivors += Math.floor(minutesPassed * (1 / 60) * upgrade.level * 0.5);\n          }\n        });\n        setResources(offlineResources);\n        setUpgrades(gameState.upgrades);\n        setLocations(gameState.locations);\n        setAutoScavengeEnabled(gameState.autoScavengeEnabled);\n      } catch (e) {\n        console.error(\"Failed to load save:\", e);\n      }\n    }\n  }, []);\n\n  // Save game\n  const saveGame = useCallback(() => {\n    const gameState = {\n      resources,\n      upgrades,\n      locations,\n      lastSave: Date.now(),\n      autoScavengeEnabled\n    };\n    localStorage.setItem(SAVE_KEY, JSON.stringify(gameState));\n  }, [resources, upgrades, locations, autoScavengeEnabled]);\n\n  // Auto save\n  useEffect(() => {\n    autoSaveRef.current = setInterval(saveGame, AUTO_SAVE_INTERVAL);\n    return () => {\n      if (autoSaveRef.current) clearInterval(autoSaveRef.current);\n    };\n  }, [saveGame]);\n  function floorResources(res) {\n    return {\n      food: Math.floor(res.food),\n      water: Math.floor(res.water),\n      materials: Math.floor(res.materials),\n      survivors: Math.floor(res.survivors)\n    };\n  }\n  function isEqualResources(a, b) {\n    return a.food === b.food && a.water === b.water && a.materials === b.materials && a.survivors === b.survivors;\n  }\n\n  // Game loop\n  useEffect(() => {\n    gameLoopRef.current = setInterval(() => {\n      setResources(prev => {\n        const newResources = {\n          ...prev\n        };\n\n        // Apply upgrade effects\n        upgrades.forEach(upgrade => {\n          if (upgrade.id === \"farm\" && upgrade.level > 0) {\n            newResources.food += 2 * upgrade.level / 60; // per second\n          }\n          if (upgrade.id === \"well\" && upgrade.level > 0) {\n            newResources.water += 1 * upgrade.level / 60;\n          }\n          if (upgrade.id === \"shelter\" && upgrade.level > 0) {\n            newResources.survivors += 1 * upgrade.level / 3600; // 1 per hour\n          }\n        });\n\n        // Survivor consumption\n        newResources.food = Math.max(0, newResources.food - prev.survivors * 0.01);\n        newResources.water = Math.max(0, newResources.water - prev.survivors * 0.02);\n\n        // Floor and compare\n        const floored = floorResources(newResources);\n        if (!isEqualResources(floored, floorResources(prev))) {\n          return floored;\n        }\n        return prev; // Skip update if unchanged\n      });\n\n      // Check for disasters\n      if (Math.random() < DISASTER_CHANCE) {\n        const disaster = disasters[Math.floor(Math.random() * disasters.length)];\n        setShowDisaster(disaster);\n        applyDisaster(disaster);\n      }\n\n      // Auto scavenging\n      if (autoScavengeEnabled) {\n        checkAutoScavenge();\n      }\n    }, 2000);\n    return () => {\n      if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n    };\n  }, [upgrades, autoScavengeEnabled]);\n  useEffect(() => {\n    const interval = setInterval(() => {\n      const now = Date.now();\n      if (waitingForScavengePopup || scavengeResult) return;\n      const finished = locations.find(loc => loc.lastScavenged && loc.scavengeTime > 0 && now - loc.lastScavenged >= loc.scavengeTime);\n      if (finished) finalizeScavenge(finished);\n    }, 1000);\n    return () => clearInterval(interval);\n  }, [locations, waitingForScavengePopup, scavengeResult]);\n  const applyDisaster = disaster => {\n    setResources(prev => ({\n      food: Math.max(0, prev.food + (disaster.effect.food || 0)),\n      water: Math.max(0, prev.water + (disaster.effect.water || 0)),\n      materials: Math.max(0, prev.materials + (disaster.effect.materials || 0)),\n      survivors: Math.max(1, prev.survivors + (disaster.effect.survivors || 0))\n    }));\n  };\n  const checkAutoScavenge = () => {\n    if (waitingForScavengePopup) return;\n    const now = Date.now();\n    setLocations(prev => {\n      let hasActiveScavenge = false;\n      let updated = false;\n      const newLocations = prev.map(loc => {\n        if (loc.lastScavenged && loc.scavengeTime > 0) {\n          if (now - loc.lastScavenged >= loc.scavengeTime && !updated) {\n            const loot = {\n              food: loc.resources.food || 0,\n              water: loc.resources.water || 0,\n              materials: loc.resources.materials || 0,\n              survivors: loc.resources.survivors || 0\n            };\n            finalizeScavenge(loc);\n            updated = true;\n            return loc;\n          }\n          hasActiveScavenge = true;\n          return loc;\n        }\n        return loc;\n      });\n      if (!hasActiveScavenge && !updated) {\n        // Start auto-scavenge on the first available location\n        const targetIndex = newLocations.findIndex(loc => loc.discovered && !loc.lastScavenged && loc.scavengeTime > 0 && Object.values(loc.resources).some(v => v && v > 0));\n        if (targetIndex !== -1) {\n          newLocations[targetIndex] = {\n            ...newLocations[targetIndex],\n            lastScavenged: now\n          };\n          updated = true;\n        }\n      }\n      return newLocations;\n    });\n  };\n  const finalizeScavenge = location => {\n    const loot = {\n      food: location.resources.food || 0,\n      water: location.resources.water || 0,\n      materials: location.resources.materials || 0,\n      survivors: location.resources.survivors || 0\n    };\n    setScavengeResult(loot);\n    setResources(prevResources => ({\n      food: prevResources.food + loot.food,\n      water: prevResources.water + loot.water,\n      materials: prevResources.materials + loot.materials,\n      survivors: prevResources.survivors + loot.survivors\n    }));\n    setWaitingForScavengePopup(true);\n    setLocations(prev => prev.map(loc => loc.id === location.id ? {\n      ...loc,\n      lastScavenged: null,\n      resources: {},\n      wasScavenged: true\n    } : loc));\n  };\n  const handleMapClick = (e, location) => {\n    e.stopPropagation();\n    if (!location.discovered && location.id !== \"base\") return;\n    setSelectedLocation(location);\n    setRadialMenuPosition({\n      x: e.clientX,\n      y: e.clientY\n    });\n    setShowRadialMenu(true);\n  };\n  const scavengeLocation = location => {\n    if (location.lastScavenged || location.scavengeTime === 0) return;\n    setLocations(prev => prev.map(loc => loc.id === location.id ? {\n      ...loc,\n      lastScavenged: Date.now()\n    } : loc));\n    setShowRadialMenu(false);\n  };\n  const exploreNearby = () => {\n    if (!selectedLocation) return;\n    const getGridCoords = id => {\n      const match = id.match(/cell-(\\d+)-(\\d+)/);\n      if (!match) return null;\n      return {\n        x: parseInt(match[1]),\n        y: parseInt(match[2])\n      };\n    };\n    const selectedCoords = getGridCoords(selectedLocation.id);\n    if (!selectedCoords) return;\n    setLocations(prev => prev.map(loc => {\n      const coords = getGridCoords(loc.id);\n      if (!coords || loc.discovered) return loc;\n      const dx = Math.abs(coords.x - selectedCoords.x);\n      const dy = Math.abs(coords.y - selectedCoords.y);\n      if (dx <= 1 && dy <= 1) {\n        return {\n          ...loc,\n          discovered: true\n        };\n      }\n      return loc;\n    }));\n    setShowRadialMenu(false);\n  };\n  const purchaseUpgrade = upgrade => {\n    if (upgrade.level >= upgrade.maxLevel) return;\n    const canAfford = Object.entries(upgrade.cost).every(([resource, cost]) => resources[resource] >= (cost || 0));\n    if (canAfford) {\n      setResources(prev => {\n        const newResources = {\n          ...prev\n        };\n        Object.entries(upgrade.cost).forEach(([resource, cost]) => {\n          newResources[resource] -= cost || 0;\n        });\n        return newResources;\n      });\n      setUpgrades(prev => prev.map(u => u.id === upgrade.id ? {\n        ...u,\n        level: u.level + 1,\n        cost: Object.fromEntries(Object.entries(u.cost).map(([r, c]) => [r, Math.floor((c || 0) * 1.5)]))\n      } : u));\n    }\n  };\n  const getScavengeProgress = location => {\n    if (!location.lastScavenged || location.scavengeTime === 0) return 0;\n    const elapsed = Date.now() - location.lastScavenged;\n    return Math.min(100, elapsed / location.scavengeTime * 100);\n  };\n  const attackLocation = location => {\n    // Placeholder for attack logic\n    console.log(`Attacking ${location.name}`);\n    setShowRadialMenu(false);\n  };\n\n  // Components\n  const ResourcePanel = /*#__PURE__*/React.memo(({\n    resources,\n    upgrades,\n    autoScavengeEnabled,\n    purchaseUpgrade,\n    setAutoScavengeEnabled\n  }) => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-gray-800 rounded-lg p-6 shadow-lg h-[calc(100%-60px)] flex flex-col\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-none\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-2xl font-bold text-gray-100 mb-6\",\n          children: \"Resources\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 589,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-2 gap-4 mb-8\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-gray-700 rounded-lg p-4 shadow-md hover:shadow-lg transition-shadow\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-300\",\n                children: \"\\uD83C\\uDF56 Food\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 593,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xl font-semibold text-green-400\",\n                children: Math.floor(resources.food)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 594,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 592,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 591,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-gray-700 rounded-lg p-4 shadow-md hover:shadow-lg transition-shadow\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-300\",\n                children: \"\\uD83D\\uDCA7 Water\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 601,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xl font-semibold text-blue-400\",\n                children: Math.floor(resources.water)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 602,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 600,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 599,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-gray-700 rounded-lg p-4 shadow-md hover:shadow-lg transition-shadow\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-300\",\n                children: \"\\uD83D\\uDD27 Materials\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 609,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xl font-semibold text-orange-400\",\n                children: Math.floor(resources.materials)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 610,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 608,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 607,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-gray-700 rounded-lg p-4 shadow-md hover:shadow-lg transition-shadow\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-between\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-300\",\n                children: \"\\uD83D\\uDC65 Survivors\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 617,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xl font-semibold text-purple-400\",\n                children: resources.survivors\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 618,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 616,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 615,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 590,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-xl font-bold text-gray-100 mb-4\",\n          children: \"Base Upgrades\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 624,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 588,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-grow overflow-y-auto md:pr-2\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-3\",\n          children: upgrades.map(upgrade => {\n            const canAfford = Object.entries(upgrade.cost).every(([resource, cost]) => resources[resource] >= (cost || 0));\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-700 rounded-lg p-3 shadow-md flex gap-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between items-center mb-2 flex-grow border-r border-gray-600 md:pr-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center gap-2\",\n                    children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                      className: \"text-sm font-semibold text-gray-100\",\n                      children: upgrade.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 645,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-xs text-green-400 mt-1\",\n                      children: upgrade.effect\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 648,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 644,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-xs text-gray-400\",\n                    children: upgrade.description\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 652,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 643,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-right\",\n                  children: /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-sm text-gray-300\",\n                    children: [\"Level \", upgrade.level, \"/\", upgrade.maxLevel]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 657,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 656,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 642,\n                columnNumber: 21\n              }, this), upgrade.level < upgrade.maxLevel && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => purchaseUpgrade(upgrade),\n                disabled: !canAfford,\n                className: `ml-auto mr-0 w-full max-w-20 sm:max-w-40 px-4 py-2 rounded-md transition-colors text-xs md:text-sm leading-4 ${canAfford ? \"bg-green-600 hover:bg-green-700 text-white\" : \"bg-gray-600 text-gray-400 cursor-not-allowed\"}`,\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"Upgrade\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 672,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [\"(\", Object.entries(upgrade.cost).map(([r, c]) => `${c} ${r}`).join(\", \"), \")\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 673,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 663,\n                columnNumber: 23\n              }, this)]\n            }, upgrade.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 638,\n              columnNumber: 19\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 630,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 629,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-none mt-4 pt-4 border-t border-gray-700\",\n        children: /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"flex items-center space-x-2 text-gray-300\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            checked: autoScavengeEnabled,\n            onChange: e => setAutoScavengeEnabled(e.target.checked),\n            className: \"rounded\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 690,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Auto-scavenge locations\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 696,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 689,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 688,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 587,\n      columnNumber: 9\n    }, this);\n  });\n  const ScavengePopup = () => {\n    if (!scavengeResult) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-gray-800 rounded-lg p-6 max-w-sm shadow-2xl\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-xl font-bold text-green-400 mb-2\",\n          children: \"Resources Found!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 710,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"text-gray-200 space-y-1 mb-4\",\n          children: Object.entries(scavengeResult).map(([key, value]) => value > 0 ? /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [key, \":\", \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-semibold text-white\",\n              children: value\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 718,\n              columnNumber: 19\n            }, this)]\n          }, key, true, {\n            fileName: _jsxFileName,\n            lineNumber: 716,\n            columnNumber: 17\n          }, this) : null)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 713,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            setScavengeResult(null);\n            setWaitingForScavengePopup(false); // Enables next scavenge\n          },\n          className: \"w-full bg-green-700 hover:bg-green-800 text-white py-2 px-4 rounded transition-colors\",\n          children: \"Continue\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 723,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 709,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 708,\n      columnNumber: 7\n    }, this);\n  };\n  const MapView = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-gray-800 rounded-lg p-2 sm:p-6 shadow-lg h-full\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-2xl font-bold text-gray-100 mb-6\",\n      children: \"Wasteland Map\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 739,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid bg-gray-900 rounded-lg aspect-square shadow-inner\",\n      style: {\n        gridTemplateColumns: `repeat(${GRID_SIZE}, 1fr)`,\n        gridTemplateRows: `repeat(${GRID_SIZE}, 1fr)`\n      },\n      onClick: () => setShowRadialMenu(false),\n      children: locations.map(location => {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `flex items-center justify-center ${location.discovered ? \"cursor-pointer\" : \"opacity-50\"}`,\n          onClick: e => handleMapClick(e, location),\n          children: location.discovered ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative group\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: `w-16 h-16 rounded-sm flex items-center justify-center text-2xl shadow-lg transform transition-transform group-hover:scale-110 ${location.id === \"base\" ? \"bg-green-600\" : \"bg-blue-600\"}`,\n              children: location.isBase ? \"🏠\" : location.wasScavenged ? \"✅\" : location.resources && Object.values(location.resources).some(val => val && val > 0) ? \"💰\" : \"\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 759,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute -bottom-6 left-1/2 transform -translate-x-1/2 whitespace-nowrap\",\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs text-gray-300\",\n                children: location.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 776,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 775,\n              columnNumber: 19\n            }, this), location.lastScavenged && location.scavengeTime > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute bottom-1 left-2 right-2 h-1 bg-gray-700 rounded\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-full bg-green-500 rounded transition-all duration-1000\",\n                style: {\n                  width: `${getScavengeProgress(location)}%`\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 780,\n                columnNumber: 23\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 779,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 758,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-16 h-16 rounded-sm bg-gray-700 flex items-center justify-center text-2xl opacity-35 animate-pulse\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 788,\n            columnNumber: 17\n          }, this)\n        }, location.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 750,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 740,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 738,\n    columnNumber: 5\n  }, this);\n  const RadialMenu = () => {\n    if (!showRadialMenu || !selectedLocation) return null;\n    const actions = [{\n      label: \"Scavenge\",\n      icon: \"🔍\",\n      enabled: !selectedLocation.lastScavenged && selectedLocation.scavengeTime > 0 && Object.values(selectedLocation.resources).some(val => val && val > 0),\n      action: () => scavengeLocation(selectedLocation)\n    }, {\n      label: \"Attack\",\n      icon: \"⚔️\",\n      enabled: selectedLocation.discovered && !selectedLocation.isBase && selectedLocation.owner !== \"player\",\n      action: () => attackLocation(selectedLocation)\n    }, {\n      label: \"Explore\",\n      icon: \"🗺️\",\n      enabled: true,\n      action: exploreNearby\n    }, {\n      label: \"Cancel\",\n      icon: \"❌\",\n      enabled: true,\n      action: () => setShowRadialMenu(false)\n    }];\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 z-50\",\n      onClick: () => setShowRadialMenu(false),\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute\",\n        style: {\n          left: radialMenuPosition.x,\n          top: radialMenuPosition.y\n        },\n        children: actions.map((action, index) => {\n          const angle = (index * 120 - 60) * (Math.PI / 180);\n          const x = Math.cos(angle) * 80;\n          const y = Math.sin(angle) * 80;\n          return /*#__PURE__*/_jsxDEV(\"button\", {\n            disabled: !action.enabled,\n            onClick: e => {\n              e.stopPropagation();\n              action.action();\n            },\n            className: `absolute transform -translate-x-1/2 -translate-y-1/2 w-16 h-16 rounded-full flex flex-col items-center justify-center text-white transition-all ${action.enabled ? \"bg-blue-600 hover:bg-blue-700 shadow-lg hover:shadow-xl\" : \"bg-gray-600 cursor-not-allowed opacity-50\"}`,\n            style: {\n              left: x,\n              top: y\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xl\",\n              children: action.icon\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 864,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs mt-1\",\n              children: action.label\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 865,\n              columnNumber: 17\n            }, this)]\n          }, action.label, true, {\n            fileName: _jsxFileName,\n            lineNumber: 850,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 840,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 836,\n      columnNumber: 7\n    }, this);\n  };\n  const DisasterPopup = () => {\n    if (!showDisaster) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-red-900 rounded-lg p-6 max-w-sm shadow-2xl animate-pulse\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-2xl font-bold text-white mb-2\",\n          children: showDisaster.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 880,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-200 mb-4\",\n          children: showDisaster.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 883,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-300 mb-4\",\n          children: Object.entries(showDisaster.effect).map(([resource, amount]) => /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [resource, \": \", amount]\n          }, resource, true, {\n            fileName: _jsxFileName,\n            lineNumber: 886,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 884,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowDisaster(null),\n          className: \"w-full bg-red-700 hover:bg-red-800 text-white py-2 px-4 rounded transition-colors\",\n          children: \"Continue\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 891,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 879,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 878,\n      columnNumber: 7\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-900 text-white\",\n    children: [isMobile ?\n    /*#__PURE__*/\n    // Mobile layout with tabs\n    _jsxDEV(\"div\", {\n      className: \"px-2 py-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-3xl font-bold text-center mb-6\",\n        children: \"Wasteland Survivor\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 907,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex mb-4 bg-gray-800 rounded-lg p-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setActiveTab(\"resources\"),\n          className: `flex-1 py-2 px-4 rounded-md transition-colors ${activeTab === \"resources\" ? \"bg-gray-700 text-white\" : \"text-gray-400 hover:text-white\"}`,\n          children: \"Resources\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 911,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setActiveTab(\"map\"),\n          className: `flex-1 py-2 px-4 rounded-md transition-colors ${activeTab === \"map\" ? \"bg-gray-700 text-white\" : \"text-gray-400 hover:text-white\"}`,\n          children: \"Map\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 921,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 910,\n        columnNumber: 11\n      }, this), activeTab === \"resources\" ? /*#__PURE__*/_jsxDEV(ResourcePanel, {\n        resources: resources,\n        upgrades: upgrades,\n        autoScavengeEnabled: autoScavengeEnabled,\n        purchaseUpgrade: purchaseUpgrade,\n        setAutoScavengeEnabled: setAutoScavengeEnabled\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 933,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(MapView, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 941,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 906,\n      columnNumber: 9\n    }, this) :\n    /*#__PURE__*/\n    // Desktop split-screen layout\n    _jsxDEV(\"div\", {\n      className: \"flex h-screen\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-1/2 p-6 overflow-y-auto\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-3xl font-bold mb-6\",\n          children: \"Wasteland Survivor\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 948,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(ResourcePanel, {\n          resources: resources,\n          upgrades: upgrades,\n          autoScavengeEnabled: autoScavengeEnabled,\n          purchaseUpgrade: purchaseUpgrade,\n          setAutoScavengeEnabled: setAutoScavengeEnabled\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 949,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 947,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-1/2 p-6 border-l border-gray-700 flex flex-col h-full\",\n        children: /*#__PURE__*/_jsxDEV(MapView, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 958,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 957,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 946,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(RadialMenu, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 963,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DisasterPopup, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 964,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ScavengePopup, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 965,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 903,\n    columnNumber: 5\n  }, this);\n};\n_s(ApocalypticGame, \"EpmQHk+qla9UGP/wa1g44NDQGWQ=\");\n_c = ApocalypticGame;\nexport default ApocalypticGame;\nvar _c;\n$RefreshReg$(_c, \"ApocalypticGame\");","map":{"version":3,"names":["React","useCallback","useEffect","useRef","useState","jsxDEV","_jsxDEV","SAVE_KEY","AUTO_SAVE_INTERVAL","DISASTER_CHANCE","initialResources","food","water","materials","survivors","disasters","id","name","description","effect","ApocalypticGame","_s","resources","setResources","activeTab","setActiveTab","isMobile","setIsMobile","showRadialMenu","setShowRadialMenu","radialMenuPosition","setRadialMenuPosition","x","y","selectedLocation","setSelectedLocation","showDisaster","setShowDisaster","autoScavengeEnabled","setAutoScavengeEnabled","scavengeResult","setScavengeResult","showAttackResult","setShowAttackResult","waitingForScavengePopup","setWaitingForScavengePopup","gameLoopRef","autoSaveRef","upgrades","setUpgrades","cost","level","maxLevel","GRID_SIZE","locationNames","generateInitialGrid","locations","isBase","Math","floor","push","discovered","scavengeTime","random","lastScavenged","owner","setLocations","resourcesRef","upgradesRef","current","checkMobile","window","innerWidth","addEventListener","removeEventListener","savedGame","localStorage","getItem","gameState","JSON","parse","timePassed","Date","now","lastSave","minutesPassed","offlineResources","forEach","upgrade","e","console","error","saveGame","setItem","stringify","setInterval","clearInterval","floorResources","res","isEqualResources","a","b","prev","newResources","max","floored","disaster","length","applyDisaster","checkAutoScavenge","interval","finished","find","loc","finalizeScavenge","hasActiveScavenge","updated","newLocations","map","loot","targetIndex","findIndex","Object","values","some","v","location","prevResources","wasScavenged","handleMapClick","stopPropagation","clientX","clientY","scavengeLocation","exploreNearby","getGridCoords","match","parseInt","selectedCoords","coords","dx","abs","dy","purchaseUpgrade","canAfford","entries","every","resource","u","fromEntries","r","c","getScavengeProgress","elapsed","min","attackLocation","log","ResourcePanel","memo","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","join","type","checked","onChange","target","ScavengePopup","key","value","MapView","style","gridTemplateColumns","gridTemplateRows","val","width","RadialMenu","actions","label","icon","enabled","action","left","top","index","angle","PI","cos","sin","DisasterPopup","amount","_c","$RefreshReg$"],"sources":["/Users/faybennett/outlierTasks/game-app/src/App.tsx"],"sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from \"react\";\n\n// Types\ninterface Resources {\n  food: number;\n  water: number;\n  materials: number;\n  survivors: number;\n}\n\ninterface BaseUpgrade {\n  id: string;\n  name: string;\n  description: string;\n  cost: Partial<Resources>;\n  effect: string;\n  level: number;\n  maxLevel: number;\n}\n\ninterface MapLocation {\n  id: string;\n  name: string;\n  x: number;\n  y: number;\n  discovered: boolean;\n  scavengeTime: number;\n  lastScavenged: number | null;\n  resources: Partial<Resources>;\n  isBase?: boolean; // Optional property to mark the base location\n  wasScavenged?: boolean; // Optional property to track if the location was already scavenged\n  owner?: string | null; // New property to track ownership\n}\n\ninterface Disaster {\n  id: string;\n  name: string;\n  description: string;\n  effect: Partial<Resources>;\n}\n\ninterface GameState {\n  resources: Resources;\n  upgrades: BaseUpgrade[];\n  locations: MapLocation[];\n  lastSave: number;\n  autoScavengeEnabled: boolean;\n}\n\n// Constants\nconst SAVE_KEY = \"apocalypse-idle-save\";\nconst AUTO_SAVE_INTERVAL = 10000; // 10 seconds\nconst DISASTER_CHANCE = 0.002; // 0.2% chance per second\n\nconst initialResources: Resources = {\n  food: 100,\n  water: 100,\n  materials: 50,\n  survivors: 5,\n};\n\nconst disasters: Disaster[] = [\n  {\n    id: \"raiders\",\n    name: \"Raider Attack!\",\n    description: \"Raiders have attacked your base!\",\n    effect: { food: -20, water: -15, materials: -10 },\n  },\n  {\n    id: \"drought\",\n    name: \"Drought\",\n    description: \"Water supplies are running low!\",\n    effect: { water: -30 },\n  },\n  {\n    id: \"sickness\",\n    name: \"Disease Outbreak\",\n    description: \"A disease has spread through your camp!\",\n    effect: { survivors: -1, food: -10 },\n  },\n];\n\nconst ApocalypticGame: React.FC = () => {\n  // State\n  const [resources, setResources] = useState<Resources>(initialResources);\n  const [activeTab, setActiveTab] = useState<\"resources\" | \"map\">(\"resources\");\n  const [isMobile, setIsMobile] = useState(false);\n  const [showRadialMenu, setShowRadialMenu] = useState(false);\n  const [radialMenuPosition, setRadialMenuPosition] = useState({ x: 0, y: 0 });\n  const [selectedLocation, setSelectedLocation] = useState<MapLocation | null>(\n    null,\n  );\n  const [showDisaster, setShowDisaster] = useState<Disaster | null>(null);\n  const [autoScavengeEnabled, setAutoScavengeEnabled] = useState(true);\n\n  const [scavengeResult, setScavengeResult] =\n    useState<Partial<Resources> | null>(null);\n  const [showAttackResult, setShowAttackResult] = useState<{ success: boolean; locationName: string; resourcesGained?: Partial<Resources>; survivorsLost?: number } | null>(null);\n\n  const [waitingForScavengePopup, setWaitingForScavengePopup] = useState(false);\n\n  const gameLoopRef = useRef<ReturnType<typeof setInterval> | null>(null);\n  const autoSaveRef = useRef<ReturnType<typeof setInterval> | null>(null);\n\n  const [upgrades, setUpgrades] = useState<BaseUpgrade[]>([\n    {\n      id: \"farm\",\n      name: \"Makeshift Farm\",\n      description: \"Produces food over time\",\n      cost: { materials: 50 },\n      effect: \"+2 food/minute\",\n      level: 0,\n      maxLevel: 5,\n    },\n    {\n      id: \"well\",\n      name: \"Water Collector\",\n      description: \"Collects water from the atmosphere\",\n      cost: { materials: 40 },\n      effect: \"+1 water/minute\",\n      level: 0,\n      maxLevel: 5,\n    },\n    {\n      id: \"shelter\",\n      name: \"Survivor Shelter\",\n      description: \"Attracts new survivors\",\n      cost: { materials: 100, food: 50 },\n      effect: \"+1 survivor chance/hour\",\n      level: 0,\n      maxLevel: 3,\n    },\n  ]);\n\n  const GRID_SIZE = 5;\n\n  const locationNames = [\n    \"Dustfield\",\n    \"Ashrock\",\n    \"Ironpit\",\n    \"Deadwell\",\n    \"Cragpoint\",\n    \"Burnpass\",\n    \"Mudspire\",\n    \"Wretchend\",\n    \"Redhollow\",\n    \"Saltmoor\",\n    \"Scraptown\",\n    \"Charcliff\",\n    \"Dryreach\",\n    \"Ragbank\",\n    \"Blightden\",\n    \"Boneplain\",\n    \"Rustbarrow\",\n    \"Smokefall\",\n    \"Shivglen\",\n    \"Flintgorge\",\n    \"Gravefen\",\n    \"Scorchbay\",\n    \"Fogscar\",\n    \"Ruinstep\",\n    \"Crimsonlot\",\n  ];\n\n  const generateInitialGrid = (): MapLocation[] => {\n    const locations: MapLocation[] = [];\n\n    for (let y = 0; y < GRID_SIZE; y++) {\n      for (let x = 0; x < GRID_SIZE; x++) {\n        const isBase =\n          x === Math.floor(GRID_SIZE / 2) && y === Math.floor(GRID_SIZE / 2);\n\n        locations.push({\n          id: `cell-${x}-${y}`,\n          name: isBase\n            ? \"Your Base\"\n            : locationNames[y * GRID_SIZE + x] || `Sector-${x}-${y}`,\n          isBase: isBase,\n          x,\n          y,\n          discovered: isBase,\n          scavengeTime: isBase ? 0 : 5000 + Math.floor(Math.random() * 5000),\n          lastScavenged: null,\n          resources: isBase\n            ? {}\n            : Math.random() < 0.6 // change of having resoureces on newly discovered locations\n            ? {\n                food: Math.floor(Math.random() * 30),\n                water: Math.floor(Math.random() * 20),\n                materials:\n                  Math.random() < 0.5 ? Math.floor(Math.random() * 40) : 0,\n                survivors: Math.random() < 0.2 ? 1 : 0,\n              }\n            : {},\n          owner: isBase ? \"player\" : null, // Set owner for base and null for others\n        });\n      }\n    }\n\n    return locations;\n  };\n\n  const [locations, setLocations] = useState<MapLocation[]>(\n    generateInitialGrid(),\n  );\n\n  const resourcesRef = useRef(resources);\n  const upgradesRef = useRef(upgrades);\n\n  // Update refs whenever state changes\n  useEffect(() => {\n    resourcesRef.current = resources;\n  }, [resources]);\n  useEffect(() => {\n    upgradesRef.current = upgrades;\n  }, [upgrades]);\n\n  // Responsive design\n  useEffect(() => {\n    const checkMobile = () => {\n      setIsMobile(window.innerWidth < 768);\n    };\n    checkMobile();\n    window.addEventListener(\"resize\", checkMobile);\n    return () => window.removeEventListener(\"resize\", checkMobile);\n  }, []);\n\n  // Load game\n  useEffect(() => {\n    const savedGame = localStorage.getItem(SAVE_KEY);\n    if (savedGame) {\n      try {\n        const gameState: GameState = JSON.parse(savedGame);\n        const timePassed = Date.now() - gameState.lastSave;\n\n        // Calculate offline progression\n        const minutesPassed = timePassed / 60000;\n        const offlineResources = { ...gameState.resources };\n\n        gameState.upgrades.forEach((upgrade) => {\n          if (upgrade.id === \"farm\" && upgrade.level > 0) {\n            offlineResources.food += Math.floor(\n              minutesPassed * 2 * upgrade.level * 0.5,\n            ); // 50% efficiency offline\n          }\n          if (upgrade.id === \"well\" && upgrade.level > 0) {\n            offlineResources.water += Math.floor(\n              minutesPassed * 1 * upgrade.level * 0.5,\n            );\n          }\n          if (upgrade.id === \"shelter\" && upgrade.level > 0) {\n            offlineResources.survivors += Math.floor(\n              minutesPassed * (1 / 60) * upgrade.level * 0.5,\n            );\n          }\n        });\n\n        setResources(offlineResources);\n        setUpgrades(gameState.upgrades);\n        setLocations(gameState.locations);\n        setAutoScavengeEnabled(gameState.autoScavengeEnabled);\n      } catch (e) {\n        console.error(\"Failed to load save:\", e);\n      }\n    }\n  }, []);\n\n  // Save game\n  const saveGame = useCallback(() => {\n    const gameState: GameState = {\n      resources,\n      upgrades,\n      locations,\n      lastSave: Date.now(),\n      autoScavengeEnabled,\n    };\n    localStorage.setItem(SAVE_KEY, JSON.stringify(gameState));\n  }, [resources, upgrades, locations, autoScavengeEnabled]);\n\n  // Auto save\n  useEffect(() => {\n    autoSaveRef.current = setInterval(saveGame, AUTO_SAVE_INTERVAL);\n    return () => {\n      if (autoSaveRef.current) clearInterval(autoSaveRef.current);\n    };\n  }, [saveGame]);\n\n  function floorResources(res: Resources): Resources {\n    return {\n      food: Math.floor(res.food),\n      water: Math.floor(res.water),\n      materials: Math.floor(res.materials),\n      survivors: Math.floor(res.survivors),\n    };\n  }\n\n  function isEqualResources(a: Resources, b: Resources): boolean {\n    return (\n      a.food === b.food &&\n      a.water === b.water &&\n      a.materials === b.materials &&\n      a.survivors === b.survivors\n    );\n  }\n\n  // Game loop\n  useEffect(() => {\n    gameLoopRef.current = setInterval(() => {\n      setResources((prev) => {\n        const newResources = { ...prev };\n\n        // Apply upgrade effects\n        upgrades.forEach((upgrade) => {\n          if (upgrade.id === \"farm\" && upgrade.level > 0) {\n            newResources.food += (2 * upgrade.level) / 60; // per second\n          }\n          if (upgrade.id === \"well\" && upgrade.level > 0) {\n            newResources.water += (1 * upgrade.level) / 60;\n          }\n          if (upgrade.id === \"shelter\" && upgrade.level > 0) {\n            newResources.survivors += (1 * upgrade.level) / 3600; // 1 per hour\n          }\n        });\n\n        // Survivor consumption\n        newResources.food = Math.max(\n          0,\n          newResources.food - prev.survivors * 0.01,\n        );\n        newResources.water = Math.max(\n          0,\n          newResources.water - prev.survivors * 0.02,\n        );\n\n        // Floor and compare\n        const floored = floorResources(newResources);\n        if (!isEqualResources(floored, floorResources(prev))) {\n          return floored;\n        }\n        return prev; // Skip update if unchanged\n      });\n\n      // Check for disasters\n      if (Math.random() < DISASTER_CHANCE) {\n        const disaster =\n          disasters[Math.floor(Math.random() * disasters.length)];\n        setShowDisaster(disaster);\n        applyDisaster(disaster);\n      }\n\n      // Auto scavenging\n      if (autoScavengeEnabled) {\n        checkAutoScavenge();\n      }\n    }, 2000);\n\n    return () => {\n      if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n    };\n  }, [upgrades, autoScavengeEnabled]);\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      const now = Date.now();\n      if (waitingForScavengePopup || scavengeResult) return;\n\n      const finished = locations.find(\n        (loc) =>\n          loc.lastScavenged &&\n          loc.scavengeTime > 0 &&\n          now - loc.lastScavenged >= loc.scavengeTime,\n      );\n\n      if (finished) finalizeScavenge(finished);\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [locations, waitingForScavengePopup, scavengeResult]);\n\n  const applyDisaster = (disaster: Disaster) => {\n    setResources((prev) => ({\n      food: Math.max(0, prev.food + (disaster.effect.food || 0)),\n      water: Math.max(0, prev.water + (disaster.effect.water || 0)),\n      materials: Math.max(0, prev.materials + (disaster.effect.materials || 0)),\n      survivors: Math.max(1, prev.survivors + (disaster.effect.survivors || 0)),\n    }));\n  };\n\n  const checkAutoScavenge = () => {\n    if (waitingForScavengePopup) return;\n\n    const now = Date.now();\n\n    setLocations((prev) => {\n      let hasActiveScavenge = false;\n      let updated = false;\n\n      const newLocations = prev.map((loc) => {\n        if (loc.lastScavenged && loc.scavengeTime > 0) {\n          if (now - loc.lastScavenged >= loc.scavengeTime && !updated) {\n            const loot = {\n              food: loc.resources.food || 0,\n              water: loc.resources.water || 0,\n              materials: loc.resources.materials || 0,\n              survivors: loc.resources.survivors || 0,\n            };\n\n            finalizeScavenge(loc);\n            updated = true;\n            return loc;\n          }\n\n          hasActiveScavenge = true;\n          return loc;\n        }\n\n        return loc;\n      });\n\n      if (!hasActiveScavenge && !updated) {\n        // Start auto-scavenge on the first available location\n        const targetIndex = newLocations.findIndex(\n          (loc) =>\n            loc.discovered &&\n            !loc.lastScavenged &&\n            loc.scavengeTime > 0 &&\n            Object.values(loc.resources).some((v) => v && v > 0),\n        );\n\n        if (targetIndex !== -1) {\n          newLocations[targetIndex] = {\n            ...newLocations[targetIndex],\n            lastScavenged: now,\n          };\n          updated = true;\n        }\n      }\n\n      return newLocations;\n    });\n  };\n\n  const finalizeScavenge = (location: MapLocation) => {\n    const loot = {\n      food: location.resources.food || 0,\n      water: location.resources.water || 0,\n      materials: location.resources.materials || 0,\n      survivors: location.resources.survivors || 0,\n    };\n\n    setScavengeResult(loot);\n    setResources((prevResources) => ({\n      food: prevResources.food + loot.food,\n      water: prevResources.water + loot.water,\n      materials: prevResources.materials + loot.materials,\n      survivors: prevResources.survivors + loot.survivors,\n    }));\n    setWaitingForScavengePopup(true);\n\n    setLocations((prev) =>\n      prev.map((loc) =>\n        loc.id === location.id\n          ? { ...loc, lastScavenged: null, resources: {}, wasScavenged: true }\n          : loc,\n      ),\n    );\n  };\n\n  const handleMapClick = (\n    e: React.MouseEvent<HTMLDivElement>,\n    location: MapLocation,\n  ) => {\n    e.stopPropagation();\n    if (!location.discovered && location.id !== \"base\") return;\n\n    setSelectedLocation(location);\n    setRadialMenuPosition({ x: e.clientX, y: e.clientY });\n    setShowRadialMenu(true);\n  };\n\n  const scavengeLocation = (location: MapLocation) => {\n    if (location.lastScavenged || location.scavengeTime === 0) return;\n\n    setLocations((prev) =>\n      prev.map((loc) =>\n        loc.id === location.id ? { ...loc, lastScavenged: Date.now() } : loc,\n      ),\n    );\n    setShowRadialMenu(false);\n  };\n\n  const exploreNearby = () => {\n    if (!selectedLocation) return;\n\n    const getGridCoords = (id: string) => {\n      const match = id.match(/cell-(\\d+)-(\\d+)/);\n      if (!match) return null;\n      return { x: parseInt(match[1]), y: parseInt(match[2]) };\n    };\n\n    const selectedCoords = getGridCoords(selectedLocation.id);\n    if (!selectedCoords) return;\n\n    setLocations((prev) =>\n      prev.map((loc) => {\n        const coords = getGridCoords(loc.id);\n        if (!coords || loc.discovered) return loc;\n\n        const dx = Math.abs(coords.x - selectedCoords.x);\n        const dy = Math.abs(coords.y - selectedCoords.y);\n\n        if (dx <= 1 && dy <= 1) {\n          return { ...loc, discovered: true };\n        }\n\n        return loc;\n      }),\n    );\n\n    setShowRadialMenu(false);\n  };\n\n  const purchaseUpgrade = (upgrade: BaseUpgrade) => {\n    if (upgrade.level >= upgrade.maxLevel) return;\n\n    const canAfford = Object.entries(upgrade.cost).every(\n      ([resource, cost]) =>\n        resources[resource as keyof Resources] >= (cost || 0),\n    );\n\n    if (canAfford) {\n      setResources((prev) => {\n        const newResources = { ...prev };\n        Object.entries(upgrade.cost).forEach(([resource, cost]) => {\n          newResources[resource as keyof Resources] -= cost || 0;\n        });\n        return newResources;\n      });\n\n      setUpgrades((prev) =>\n        prev.map((u) =>\n          u.id === upgrade.id\n            ? {\n                ...u,\n                level: u.level + 1,\n                cost: Object.fromEntries(\n                  Object.entries(u.cost).map(([r, c]) => [\n                    r,\n                    Math.floor((c || 0) * 1.5),\n                  ]),\n                ),\n              }\n            : u,\n        ),\n      );\n    }\n  };\n\n  const getScavengeProgress = (location: MapLocation) => {\n    if (!location.lastScavenged || location.scavengeTime === 0) return 0;\n    const elapsed = Date.now() - location.lastScavenged;\n    return Math.min(100, (elapsed / location.scavengeTime) * 100);\n  };\n\n  const attackLocation = (location: MapLocation) => {\n    // Placeholder for attack logic\n    console.log(`Attacking ${location.name}`);\n    setShowRadialMenu(false);\n  };\n\n  // Components\n  const ResourcePanel = React.memo(\n    ({\n      resources,\n      upgrades,\n      autoScavengeEnabled,\n      purchaseUpgrade,\n      setAutoScavengeEnabled,\n    }: {\n      resources: Resources;\n      upgrades: BaseUpgrade[];\n      autoScavengeEnabled: boolean;\n      purchaseUpgrade: (upgrade: BaseUpgrade) => void;\n      setAutoScavengeEnabled: (enabled: boolean) => void;\n    }) => {\n      return (\n        <div className=\"bg-gray-800 rounded-lg p-6 shadow-lg h-[calc(100%-60px)] flex flex-col\">\n          <div className=\"flex-none\">\n            <h2 className=\"text-2xl font-bold text-gray-100 mb-6\">Resources</h2>\n            <div className=\"grid grid-cols-2 gap-4 mb-8\">\n              <div className=\"bg-gray-700 rounded-lg p-4 shadow-md hover:shadow-lg transition-shadow\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-gray-300\">🍖 Food</span>\n                  <span className=\"text-xl font-semibold text-green-400\">\n                    {Math.floor(resources.food)}\n                  </span>\n                </div>\n              </div>\n              <div className=\"bg-gray-700 rounded-lg p-4 shadow-md hover:shadow-lg transition-shadow\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-gray-300\">💧 Water</span>\n                  <span className=\"text-xl font-semibold text-blue-400\">\n                    {Math.floor(resources.water)}\n                  </span>\n                </div>\n              </div>\n              <div className=\"bg-gray-700 rounded-lg p-4 shadow-md hover:shadow-lg transition-shadow\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-gray-300\">🔧 Materials</span>\n                  <span className=\"text-xl font-semibold text-orange-400\">\n                    {Math.floor(resources.materials)}\n                  </span>\n                </div>\n              </div>\n              <div className=\"bg-gray-700 rounded-lg p-4 shadow-md hover:shadow-lg transition-shadow\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-gray-300\">👥 Survivors</span>\n                  <span className=\"text-xl font-semibold text-purple-400\">\n                    {resources.survivors}\n                  </span>\n                </div>\n              </div>\n            </div>\n            <h3 className=\"text-xl font-bold text-gray-100 mb-4\">\n              Base Upgrades\n            </h3>\n          </div>\n\n          <div className=\"flex-grow overflow-y-auto md:pr-2\">\n            <div className=\"space-y-3\">\n              {upgrades.map((upgrade) => {\n                const canAfford = Object.entries(upgrade.cost).every(\n                  ([resource, cost]) =>\n                    resources[resource as keyof Resources] >= (cost || 0),\n                );\n\n                return (\n                  <div\n                    key={upgrade.id}\n                    className=\"bg-gray-700 rounded-lg p-3 shadow-md flex gap-4\"\n                  >\n                    <div className=\"flex justify-between items-center mb-2 flex-grow border-r border-gray-600 md:pr-4\">\n                      <div>\n                        <div className=\"flex items-center gap-2\">\n                          <h4 className=\"text-sm font-semibold text-gray-100\">\n                            {upgrade.name}\n                          </h4>\n                          <p className=\"text-xs text-green-400 mt-1\">\n                            {upgrade.effect}\n                          </p>\n                        </div>\n                        <p className=\"text-xs text-gray-400\">\n                          {upgrade.description}\n                        </p>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-sm text-gray-300\">\n                          Level {upgrade.level}/{upgrade.maxLevel}\n                        </p>\n                      </div>\n                    </div>\n                    {upgrade.level < upgrade.maxLevel && (\n                      <button\n                        onClick={() => purchaseUpgrade(upgrade)}\n                        disabled={!canAfford}\n                        className={`ml-auto mr-0 w-full max-w-20 sm:max-w-40 px-4 py-2 rounded-md transition-colors text-xs md:text-sm leading-4 ${\n                          canAfford\n                            ? \"bg-green-600 hover:bg-green-700 text-white\"\n                            : \"bg-gray-600 text-gray-400 cursor-not-allowed\"\n                        }`}\n                      >\n                        <p>Upgrade</p>\n                        <p>\n                          (\n                          {Object.entries(upgrade.cost)\n                            .map(([r, c]) => `${c} ${r}`)\n                            .join(\", \")}\n                          )\n                        </p>\n                      </button>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n\n          <div className=\"flex-none mt-4 pt-4 border-t border-gray-700\">\n            <label className=\"flex items-center space-x-2 text-gray-300\">\n              <input\n                type=\"checkbox\"\n                checked={autoScavengeEnabled}\n                onChange={(e) => setAutoScavengeEnabled(e.target.checked)}\n                className=\"rounded\"\n              />\n              <span>Auto-scavenge locations</span>\n            </label>\n          </div>\n        </div>\n      );\n    },\n  );\n\n  const ScavengePopup = () => {\n    if (!scavengeResult) return null;\n\n    return (\n      <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50\">\n        <div className=\"bg-gray-800 rounded-lg p-6 max-w-sm shadow-2xl\">\n          <h3 className=\"text-xl font-bold text-green-400 mb-2\">\n            Resources Found!\n          </h3>\n          <ul className=\"text-gray-200 space-y-1 mb-4\">\n            {Object.entries(scavengeResult).map(([key, value]) =>\n              value > 0 ? (\n                <li key={key}>\n                  {key}:{\" \"}\n                  <span className=\"font-semibold text-white\">{value}</span>\n                </li>\n              ) : null,\n            )}\n          </ul>\n          <button\n            onClick={() => {\n              setScavengeResult(null);\n              setWaitingForScavengePopup(false); // Enables next scavenge\n            }}\n            className=\"w-full bg-green-700 hover:bg-green-800 text-white py-2 px-4 rounded transition-colors\"\n          >\n            Continue\n          </button>\n        </div>\n      </div>\n    );\n  };\n\n  const MapView = () => (\n    <div className=\"bg-gray-800 rounded-lg p-2 sm:p-6 shadow-lg h-full\">\n      <h2 className=\"text-2xl font-bold text-gray-100 mb-6\">Wasteland Map</h2>\n      <div\n        className=\"grid bg-gray-900 rounded-lg aspect-square shadow-inner\"\n        style={{\n          gridTemplateColumns: `repeat(${GRID_SIZE}, 1fr)`,\n          gridTemplateRows: `repeat(${GRID_SIZE}, 1fr)`,\n        }}\n        onClick={() => setShowRadialMenu(false)}\n      >\n        {locations.map((location) => {\n          return (\n            <div\n              key={location.id}\n              className={`flex items-center justify-center ${\n                location.discovered ? \"cursor-pointer\" : \"opacity-50\"\n              }`}\n              onClick={(e) => handleMapClick(e, location)}\n            >\n              {location.discovered ? (\n                <div className=\"relative group\">\n                  <div\n                    className={`w-16 h-16 rounded-sm flex items-center justify-center text-2xl shadow-lg transform transition-transform group-hover:scale-110 ${\n                      location.id === \"base\" ? \"bg-green-600\" : \"bg-blue-600\"\n                    }`}\n                  >\n                    {location.isBase\n                      ? \"🏠\"\n                      : location.wasScavenged\n                      ? \"✅\"\n                      : location.resources &&\n                        Object.values(location.resources).some(\n                          (val) => val && val > 0,\n                        )\n                      ? \"💰\"\n                      : \"\"}\n                  </div>\n                  <div className=\"absolute -bottom-6 left-1/2 transform -translate-x-1/2 whitespace-nowrap\">\n                    <p className=\"text-xs text-gray-300\">{location.name}</p>\n                  </div>\n                  {location.lastScavenged && location.scavengeTime > 0 && (\n                    <div className=\"absolute bottom-1 left-2 right-2 h-1 bg-gray-700 rounded\">\n                      <div\n                        className=\"h-full bg-green-500 rounded transition-all duration-1000\"\n                        style={{ width: `${getScavengeProgress(location)}%` }}\n                      />\n                    </div>\n                  )}\n                </div>\n              ) : (\n                <div className=\"w-16 h-16 rounded-sm bg-gray-700 flex items-center justify-center text-2xl opacity-35 animate-pulse\"></div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n\n  const RadialMenu = () => {\n    if (!showRadialMenu || !selectedLocation) return null;\n\n    const actions = [\n      {\n        label: \"Scavenge\",\n        icon: \"🔍\",\n        enabled:\n          !selectedLocation.lastScavenged &&\n          selectedLocation.scavengeTime > 0 &&\n          Object.values(selectedLocation.resources).some(\n            (val) => val && val > 0,\n          ),\n        action: () => scavengeLocation(selectedLocation),\n      },\n      {\n        label: \"Attack\",\n        icon: \"⚔️\",\n        enabled: \n          selectedLocation.discovered && \n          !selectedLocation.isBase &&\n          selectedLocation.owner !== \"player\",\n        action: () => attackLocation(selectedLocation),\n      },\n      {\n        label: \"Explore\",\n        icon: \"🗺️\",\n        enabled: true,\n        action: exploreNearby,\n      },\n      {\n        label: \"Cancel\",\n        icon: \"❌\",\n        enabled: true,\n        action: () => setShowRadialMenu(false),\n      },\n    ];\n\n    return (\n      <div\n        className=\"fixed inset-0 z-50\"\n        onClick={() => setShowRadialMenu(false)}\n      >\n        <div\n          className=\"absolute\"\n          style={{ left: radialMenuPosition.x, top: radialMenuPosition.y }}\n        >\n          {actions.map((action, index) => {\n            const angle = (index * 120 - 60) * (Math.PI / 180);\n            const x = Math.cos(angle) * 80;\n            const y = Math.sin(angle) * 80;\n\n            return (\n              <button\n                key={action.label}\n                disabled={!action.enabled}\n                onClick={(e) => {\n                  e.stopPropagation();\n                  action.action();\n                }}\n                className={`absolute transform -translate-x-1/2 -translate-y-1/2 w-16 h-16 rounded-full flex flex-col items-center justify-center text-white transition-all ${\n                  action.enabled\n                    ? \"bg-blue-600 hover:bg-blue-700 shadow-lg hover:shadow-xl\"\n                    : \"bg-gray-600 cursor-not-allowed opacity-50\"\n                }`}\n                style={{ left: x, top: y }}\n              >\n                <span className=\"text-xl\">{action.icon}</span>\n                <span className=\"text-xs mt-1\">{action.label}</span>\n              </button>\n            );\n          })}\n        </div>\n      </div>\n    );\n  };\n\n  const DisasterPopup = () => {\n    if (!showDisaster) return null;\n\n    return (\n      <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n        <div className=\"bg-red-900 rounded-lg p-6 max-w-sm shadow-2xl animate-pulse\">\n          <h3 className=\"text-2xl font-bold text-white mb-2\">\n            {showDisaster.name}\n          </h3>\n          <p className=\"text-gray-200 mb-4\">{showDisaster.description}</p>\n          <div className=\"text-sm text-gray-300 mb-4\">\n            {Object.entries(showDisaster.effect).map(([resource, amount]) => (\n              <p key={resource}>\n                {resource}: {amount}\n              </p>\n            ))}\n          </div>\n          <button\n            onClick={() => setShowDisaster(null)}\n            className=\"w-full bg-red-700 hover:bg-red-800 text-white py-2 px-4 rounded transition-colors\"\n          >\n            Continue\n          </button>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-900 text-white\">\n      {isMobile ? (\n        // Mobile layout with tabs\n        <div className=\"px-2 py-4\">\n          <h1 className=\"text-3xl font-bold text-center mb-6\">\n            Wasteland Survivor\n          </h1>\n          <div className=\"flex mb-4 bg-gray-800 rounded-lg p-1\">\n            <button\n              onClick={() => setActiveTab(\"resources\")}\n              className={`flex-1 py-2 px-4 rounded-md transition-colors ${\n                activeTab === \"resources\"\n                  ? \"bg-gray-700 text-white\"\n                  : \"text-gray-400 hover:text-white\"\n              }`}\n            >\n              Resources\n            </button>\n            <button\n              onClick={() => setActiveTab(\"map\")}\n              className={`flex-1 py-2 px-4 rounded-md transition-colors ${\n                activeTab === \"map\"\n                  ? \"bg-gray-700 text-white\"\n                  : \"text-gray-400 hover:text-white\"\n              }`}\n            >\n              Map\n            </button>\n          </div>\n          {activeTab === \"resources\" ? (\n            <ResourcePanel\n              resources={resources}\n              upgrades={upgrades}\n              autoScavengeEnabled={autoScavengeEnabled}\n              purchaseUpgrade={purchaseUpgrade}\n              setAutoScavengeEnabled={setAutoScavengeEnabled}\n            />\n          ) : (\n            <MapView />\n          )}\n        </div>\n      ) : (\n        // Desktop split-screen layout\n        <div className=\"flex h-screen\">\n          <div className=\"w-1/2 p-6 overflow-y-auto\">\n            <h1 className=\"text-3xl font-bold mb-6\">Wasteland Survivor</h1>\n            <ResourcePanel\n              resources={resources}\n              upgrades={upgrades}\n              autoScavengeEnabled={autoScavengeEnabled}\n              purchaseUpgrade={purchaseUpgrade}\n              setAutoScavengeEnabled={setAutoScavengeEnabled}\n            />\n          </div>\n          <div className=\"w-1/2 p-6 border-l border-gray-700 flex flex-col h-full\">\n            <MapView />\n          </div>\n        </div>\n      )}\n\n      <RadialMenu />\n      <DisasterPopup />\n      <ScavengePopup />\n    </div>\n  );\n};\n\nexport default ApocalypticGame;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}