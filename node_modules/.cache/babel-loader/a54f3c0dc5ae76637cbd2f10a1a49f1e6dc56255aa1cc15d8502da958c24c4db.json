{"ast":null,"code":"var _jsxFileName = \"/Users/faybennett/outlierTasks/game-app/src/App.tsx\",\n  _s = $RefreshSig$();\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\n\n// Types\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n// Constants\nconst SAVE_KEY = \"apocalypse-idle-save\";\nconst AUTO_SAVE_INTERVAL = 10000; // 10 secon\nconst DISASTER_CHANCE = 0.002;\nconst AI_ATTACK_CHANCE = 0.02;\nconst HOUSE_CAPACITY = 2;\nconst UNHOUSED_SURVIVOR_DEATH_RATE = 0.01;\nconst EXPLORATION_COST = {\n  materials: 20\n};\nconst initialResources = {\n  food: 100,\n  water: 100,\n  materials: 50,\n  survivors: 5\n};\nconst disasters = [{\n  id: \"raiders\",\n  name: \"Raider Attack!\",\n  description: \"Raiders have attacked your base!\",\n  effect: {\n    food: -20,\n    water: -15,\n    materials: -10\n  }\n}, {\n  id: \"drought\",\n  name: \"Drought\",\n  description: \"Water supplies are running low!\",\n  effect: {\n    water: -30\n  }\n}, {\n  id: \"sickness\",\n  name: \"Disease Outbreak\",\n  description: \"A disease has spread through your camp!\",\n  effect: {\n    survivors: -1,\n    food: -10\n  }\n}];\n\n// Update icon components to accept className props\nconst FoodIcon = ({\n  className = \"h-8 w-8\"\n}) => /*#__PURE__*/_jsxDEV(\"svg\", {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  className: className,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: \"2\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  children: [/*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M18 8h1a4 4 0 0 1 0 8h-1\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 119,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n    x1: \"6\",\n    y1: \"1\",\n    x2: \"6\",\n    y2: \"4\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 120,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n    x1: \"10\",\n    y1: \"1\",\n    x2: \"10\",\n    y2: \"4\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 121,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n    x1: \"14\",\n    y1: \"1\",\n    x2: \"14\",\n    y2: \"4\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 122,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 117,\n  columnNumber: 3\n}, this);\n_c = FoodIcon;\nconst WaterIcon = ({\n  className = \"h-8 w-8\"\n}) => /*#__PURE__*/_jsxDEV(\"svg\", {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  className: className,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: \"2\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  children: /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 128,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 127,\n  columnNumber: 3\n}, this);\n_c2 = WaterIcon;\nconst MaterialsIcon = ({\n  className = \"h-8 w-8\"\n}) => /*#__PURE__*/_jsxDEV(\"svg\", {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  className: className,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: \"2\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  children: /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 134,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 133,\n  columnNumber: 3\n}, this);\n_c3 = MaterialsIcon;\nconst SurvivorsIcon = ({\n  className = \"h-8 w-8\"\n}) => /*#__PURE__*/_jsxDEV(\"svg\", {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  className: className,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: \"2\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  children: [/*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 140,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n    cx: \"9\",\n    cy: \"7\",\n    r: \"4\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 141,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M23 21v-2a4 4 0 0 0-3-3.87\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 142,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M16 3.13a4 4 0 0 1 0 7.75\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 143,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 139,\n  columnNumber: 3\n}, this);\n_c4 = SurvivorsIcon;\nconst BaseIcon = ({\n  className = \"h-8 w-8\"\n}) => /*#__PURE__*/_jsxDEV(\"svg\", {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  className: className,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: \"2\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  children: [/*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 149,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"polyline\", {\n    points: \"9 22 9 12 15 12 15 22\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 150,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 148,\n  columnNumber: 3\n}, this);\n_c5 = BaseIcon;\nconst ResourcesIcon = ({\n  className = \"h-8 w-8\"\n}) => /*#__PURE__*/_jsxDEV(\"svg\", {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  className: className,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: \"2\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  children: [/*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 156,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n    x1: \"16\",\n    y1: \"8\",\n    x2: \"2\",\n    y2: \"22\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 157,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n    x1: \"17.5\",\n    y1: \"15\",\n    x2: \"9\",\n    y2: \"15\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 158,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 155,\n  columnNumber: 3\n}, this);\n_c6 = ResourcesIcon;\nconst AttackIcon = ({\n  className = \"h-8 w-8\"\n}) => /*#__PURE__*/_jsxDEV(\"svg\", {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  className: className,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: \"2\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  children: [/*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M12 19l7-7 3 3-7 7-3-3z\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 164,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 165,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n    d: \"M2 2l7.586 7.586\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 166,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n    cx: \"11\",\n    cy: \"11\",\n    r: \"2\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 167,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 163,\n  columnNumber: 3\n}, this);\n_c7 = AttackIcon;\nconst ExploreIcon = ({\n  className = \"h-8 w-8\"\n}) => /*#__PURE__*/_jsxDEV(\"svg\", {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  className: className,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: \"2\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n    cx: \"12\",\n    cy: \"12\",\n    r: \"10\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 173,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"polygon\", {\n    points: \"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 174,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 172,\n  columnNumber: 3\n}, this);\n_c8 = ExploreIcon;\nconst CancelIcon = ({\n  className = \"h-8 w-8\"\n}) => /*#__PURE__*/_jsxDEV(\"svg\", {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  className: className,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: \"2\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  children: [/*#__PURE__*/_jsxDEV(\"line\", {\n    x1: \"18\",\n    y1: \"6\",\n    x2: \"6\",\n    y2: \"18\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 180,\n    columnNumber: 5\n  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n    x1: \"6\",\n    y1: \"6\",\n    x2: \"18\",\n    y2: \"18\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 181,\n    columnNumber: 5\n  }, this)]\n}, void 0, true, {\n  fileName: _jsxFileName,\n  lineNumber: 179,\n  columnNumber: 3\n}, this);\n_c9 = CancelIcon;\nconst ApocalypticGame = () => {\n  _s();\n  // State\n  const [resources, setResources] = useState(initialResources);\n  const [activeTab, setActiveTab] = useState(\"resources\");\n  const [isMobile, setIsMobile] = useState(false);\n  const [showRadialMenu, setShowRadialMenu] = useState(false);\n  const [radialMenuPosition, setRadialMenuPosition] = useState({\n    x: 0,\n    y: 0\n  });\n  const [selectedLocation, setSelectedLocation] = useState(null);\n  const [showDisaster, setShowDisaster] = useState(null);\n  const [autoScavengeEnabled, setAutoScavengeEnabled] = useState(true);\n  const [buildings, setBuildings] = useState([]);\n  const [scavengeResult, setScavengeResult] = useState(null);\n  const [showAttackResult, setShowAttackResult] = useState(null);\n  const [showAIAttack, setShowAIAttack] = useState(null); // New state for AI attack results\n  const [showAttackedAnimation, setShowAttackedAnimation] = useState(null); // New state for AI attack animation\n  const [showHowToPlay, setShowHowToPlay] = useState(false); // New state for How to Play popup\n\n  const [waitingForScavengePopup, setWaitingForScavengePopup] = useState(false);\n  const gameLoopRef = useRef(null);\n  const autoSaveRef = useRef(null);\n  const [upgrades, setUpgrades] = useState([{\n    id: \"farm\",\n    name: \"Makeshift Farm\",\n    description: \"Produces food over time\",\n    cost: {\n      materials: 50\n    },\n    effect: \"+5 food/minute\",\n    level: 0,\n    maxLevel: 5\n  }, {\n    id: \"well\",\n    name: \"Water Collector\",\n    description: \"Collects water from the atmosphere\",\n    cost: {\n      materials: 40\n    },\n    effect: \"+3 water/minute\",\n    level: 0,\n    maxLevel: 5\n  }, {\n    id: \"shelter\",\n    name: \"Survivor Shelter\",\n    description: \"Attracts new survivors\",\n    cost: {\n      materials: 100,\n      food: 50\n    },\n    effect: \"+1 survivor chance/hour\",\n    level: 0,\n    maxLevel: 3\n  }]);\n  const GRID_SIZE = 5;\n  const locationNames = [\"Dustfield\", \"Ashrock\", \"Ironpit\", \"Deadwell\", \"Cragpoint\", \"Burnpass\", \"Mudspire\", \"Wretchend\", \"Redhollow\", \"Saltmoor\", \"Scraptown\", \"Charcliff\", \"Dryreach\", \"Ragbank\", \"Blightden\", \"Boneplain\", \"Rustbarrow\", \"Smokefall\", \"Shivglen\", \"Flintgorge\", \"Gravefen\", \"Scorchbay\", \"Fogscar\", \"Ruinstep\", \"Crimsonlot\"];\n  const generateInitialGrid = () => {\n    const locations = [];\n    for (let y = 0; y < GRID_SIZE; y++) {\n      for (let x = 0; x < GRID_SIZE; x++) {\n        const isBase = x === Math.floor(GRID_SIZE / 2) && y === Math.floor(GRID_SIZE / 2);\n        locations.push({\n          id: `cell-${x}-${y}`,\n          name: isBase ? \"Your Base\" : locationNames[y * GRID_SIZE + x] || `Sector-${x}-${y}`,\n          isBase: isBase,\n          x,\n          y,\n          discovered: isBase,\n          scavengeTime: isBase ? 0 : 5000 + Math.floor(Math.random() * 5000),\n          lastScavenged: null,\n          resources: isBase ? {} : Math.random() < 0.8 // Increased chance of having resources on newly discovered locations\n          ? {\n            food: Math.floor(Math.random() * 50) + 10,\n            // Increased food range\n            water: Math.floor(Math.random() * 30) + 5,\n            // Increased water range\n            materials: Math.random() < 0.7 ? Math.floor(Math.random() * 60) + 10 : 0,\n            // Increased material chance and range\n            survivors: Math.random() < 0.3 ? 1 : 0 // Slightly increased survivor chance\n          } : {},\n          owner: isBase ? \"player\" : null // Set owner for base and null for others\n        });\n      }\n    }\n    return locations;\n  };\n  const [locations, setLocations] = useState(generateInitialGrid());\n  const availableBuildings = [{\n    id: \"house-blueprint\",\n    type: \"house\",\n    name: \"House\",\n    cost: {\n      materials: 30,\n      food: 10\n    },\n    level: 0,\n    imageUrl: \"https://img.icons8.com/ios-filled/50/ffffff/home.png\"\n  }\n  // { id: \"water-collector-blueprint\", type: \"water_collector\", name: \"Water Collector\", cost: { materials: 40 }, imageUrl: \"https://i.imgur.com/your-water-collector-image.png\" },\n  ];\n  const resourcesRef = useRef(resources);\n  const upgradesRef = useRef(upgrades);\n\n  // Update refs whenever state changes\n  useEffect(() => {\n    resourcesRef.current = resources;\n  }, [resources]);\n  useEffect(() => {\n    upgradesRef.current = upgrades;\n  }, [upgrades]);\n\n  // Responsive design\n  useEffect(() => {\n    const checkMobile = () => {\n      setIsMobile(window.innerWidth < 768);\n    };\n    checkMobile();\n    window.addEventListener(\"resize\", checkMobile);\n    return () => window.removeEventListener(\"resize\", checkMobile);\n  }, []);\n\n  // Load game\n  useEffect(() => {\n    const savedGame = localStorage.getItem(SAVE_KEY);\n    if (savedGame) {\n      try {\n        const gameState = JSON.parse(savedGame);\n        const timePassed = Date.now() - gameState.lastSave;\n\n        // Calculate offline progression\n        const minutesPassed = timePassed / 60000;\n        const offlineResources = {\n          ...gameState.resources\n        };\n        gameState.upgrades.forEach(upgrade => {\n          if (upgrade.id === \"farm\" && upgrade.level > 0) {\n            offlineResources.food += Math.floor(minutesPassed * 5 * upgrade.level * 0.5); // 50% efficiency offline\n          }\n          if (upgrade.id === \"well\" && upgrade.level > 0) {\n            offlineResources.water += Math.floor(minutesPassed * 3 * upgrade.level * 0.5);\n          }\n          if (upgrade.id === \"shelter\" && upgrade.level > 0) {\n            offlineResources.survivors += Math.floor(minutesPassed * (1 / 60) * upgrade.level * 0.5);\n          }\n        });\n        setResources(offlineResources);\n        setUpgrades(gameState.upgrades);\n        setLocations(gameState.locations);\n        setAutoScavengeEnabled(gameState.autoScavengeEnabled);\n      } catch (e) {\n        console.error(\"Failed to load save:\", e);\n      }\n    }\n  }, []);\n\n  // Save game\n  const saveGame = useCallback(() => {\n    const gameState = {\n      resources,\n      upgrades,\n      locations,\n      lastSave: Date.now(),\n      autoScavengeEnabled\n    };\n    localStorage.setItem(SAVE_KEY, JSON.stringify(gameState));\n  }, [resources, upgrades, locations, autoScavengeEnabled]);\n\n  // Auto save\n  useEffect(() => {\n    autoSaveRef.current = setInterval(saveGame, AUTO_SAVE_INTERVAL);\n    return () => {\n      if (autoSaveRef.current) clearInterval(autoSaveRef.current);\n    };\n  }, [saveGame]);\n  function floorResources(res) {\n    return {\n      food: Math.floor(res.food),\n      water: Math.floor(res.water),\n      materials: Math.floor(res.materials),\n      survivors: Math.floor(res.survivors)\n    };\n  }\n  function isEqualResources(a, b) {\n    return a.food === b.food && a.water === b.water && a.materials === b.materials && a.survivors === b.survivors;\n  }\n\n  // Game loop\n  useEffect(() => {\n    gameLoopRef.current = setInterval(() => {\n      setResources(prev => {\n        const newResources = {\n          ...prev\n        };\n\n        // Apply upgrade effects\n        upgrades.forEach(upgrade => {\n          if (upgrade.id === \"farm\" && upgrade.level > 0) {\n            newResources.food += 5 * upgrade.level / 60; // per second\n          }\n          if (upgrade.id === \"well\" && upgrade.level > 0) {\n            newResources.water += 3 * upgrade.level / 60;\n          }\n          if (upgrade.id === \"shelter\" && upgrade.level > 0) {\n            newResources.survivors += 1 * upgrade.level / 3600; // 1 per hour\n          }\n        });\n\n        // Housing check: survivors freeze and die if not enough houses\n        const totalHousingCapacity = buildings.filter(b => b.type === \"house\").length * HOUSE_CAPACITY;\n        const unhousedSurvivors = newResources.survivors - totalHousingCapacity;\n        if (unhousedSurvivors > 0 && Math.random() < UNHOUSED_SURVIVOR_DEATH_RATE * unhousedSurvivors) {\n          const lostSurvivors = Math.min(Math.ceil(unhousedSurvivors / 5), newResources.survivors); // Lose a fraction of unhoused survivors or at least 1\n          newResources.survivors = Math.max(0, newResources.survivors - lostSurvivors);\n          setShowDisaster({\n            id: \"exposure\",\n            name: \"Exposure!\",\n            description: `Some of your unhoused survivors froze to death! Lost ${lostSurvivors} survivor(s).`,\n            // Dynamic message\n            effect: {\n              survivors: -lostSurvivors\n            }\n          });\n        }\n\n        // Survivor consumption\n        newResources.food = Math.max(0, newResources.food - prev.survivors * 0.01);\n        newResources.water = Math.max(0, newResources.water - prev.survivors * 0.02);\n\n        // Floor and compare\n        const floored = floorResources(newResources);\n        if (!isEqualResources(floored, floorResources(prev))) {\n          return floored;\n        }\n        return prev; // Skip update if unchanged\n      });\n\n      // Check for disasters\n      if (Math.random() < DISASTER_CHANCE) {\n        const disaster = disasters[Math.floor(Math.random() * disasters.length)];\n        setShowDisaster(disaster);\n        applyDisaster(disaster);\n      }\n\n      // Check for AI attacks\n      if (Math.random() < AI_ATTACK_CHANCE) {\n        triggerAIAttack();\n      }\n\n      // Auto scavenging\n      if (autoScavengeEnabled) {\n        checkAutoScavenge();\n      }\n    }, 2000);\n    return () => {\n      if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n    };\n  }, [upgrades, autoScavengeEnabled]);\n  useEffect(() => {\n    const interval = setInterval(() => {\n      const now = Date.now();\n      if (waitingForScavengePopup || scavengeResult) return;\n      const finished = locations.find(loc => loc.lastScavenged && loc.scavengeTime > 0 && now - loc.lastScavenged >= loc.scavengeTime);\n      if (finished) finalizeScavenge(finished);\n    }, 1000);\n    return () => clearInterval(interval);\n  }, [locations, waitingForScavengePopup, scavengeResult]);\n  const applyDisaster = disaster => {\n    setResources(prev => ({\n      food: Math.max(0, prev.food + (disaster.effect.food || 0)),\n      water: Math.max(0, prev.water + (disaster.effect.water || 0)),\n      materials: Math.max(0, prev.materials + (disaster.effect.materials || 0)),\n      survivors: Math.max(1, prev.survivors + (disaster.effect.survivors || 0))\n    }));\n  };\n  const checkAutoScavenge = () => {\n    if (waitingForScavengePopup) return;\n    const now = Date.now();\n    setLocations(prev => {\n      let hasActiveScavenge = false;\n      let updated = false;\n      const newLocations = prev.map(loc => {\n        if (loc.lastScavenged && loc.scavengeTime > 0) {\n          if (now - loc.lastScavenged >= loc.scavengeTime && !updated) {\n            const loot = {\n              food: loc.resources.food || 0,\n              water: loc.resources.water || 0,\n              materials: loc.resources.materials || 0,\n              survivors: loc.resources.survivors || 0\n            };\n            finalizeScavenge(loc);\n            updated = true;\n            return loc;\n          }\n          hasActiveScavenge = true;\n          return loc;\n        }\n        return loc;\n      });\n      if (!hasActiveScavenge && !updated) {\n        // Start auto-scavenge on the first available location\n        const targetIndex = newLocations.findIndex(loc => loc.discovered && !loc.lastScavenged && loc.scavengeTime > 0 && Object.values(loc.resources).some(v => v && v > 0));\n        if (targetIndex !== -1) {\n          newLocations[targetIndex] = {\n            ...newLocations[targetIndex],\n            lastScavenged: now\n          };\n          updated = true;\n        }\n      }\n      return newLocations;\n    });\n  };\n  const finalizeScavenge = location => {\n    const loot = {\n      food: location.resources.food || 0,\n      water: location.resources.water || 0,\n      materials: location.resources.materials || 0,\n      survivors: location.resources.survivors || 0\n    };\n    setScavengeResult(loot);\n    setResources(prevResources => ({\n      food: prevResources.food + loot.food,\n      water: prevResources.water + loot.water,\n      materials: prevResources.materials + loot.materials,\n      survivors: prevResources.survivors + loot.survivors\n    }));\n    setWaitingForScavengePopup(true);\n    setLocations(prev => prev.map(loc => loc.id === location.id ? {\n      ...loc,\n      lastScavenged: null,\n      resources: {},\n      wasScavenged: true\n    } : loc));\n  };\n  const handleMapClick = (e, location) => {\n    e.stopPropagation();\n    if (!location.discovered && location.id !== \"base\") return;\n    setSelectedLocation(location);\n    setRadialMenuPosition({\n      x: e.clientX,\n      y: e.clientY\n    });\n    setShowRadialMenu(true);\n  };\n  const scavengeLocation = location => {\n    if (location.lastScavenged || location.scavengeTime === 0) return;\n    setLocations(prev => prev.map(loc => loc.id === location.id ? {\n      ...loc,\n      lastScavenged: Date.now()\n    } : loc));\n    setShowRadialMenu(false);\n  };\n  const exploreNearby = () => {\n    if (!selectedLocation) return;\n    const cost = EXPLORATION_COST;\n    const canAfford = Object.entries(cost).every(([resource, amount]) => resources[resource] >= (amount || 0));\n    if (!canAfford) {\n      // Show a message that you can't afford to explore\n      setShowAttackResult({\n        success: false,\n        locationName: \"Exploration\",\n        survivorsLost: 0\n      });\n      setShowRadialMenu(false);\n      return;\n    }\n\n    // Deduct cost\n    setResources(prev => {\n      const newResources = {\n        ...prev\n      };\n      Object.entries(cost).forEach(([resource, amount]) => {\n        newResources[resource] -= amount || 0;\n      });\n      return newResources;\n    });\n    const getGridCoords = id => {\n      const match = id.match(/cell-(\\d+)-(\\d+)/);\n      if (!match) return null;\n      return {\n        x: parseInt(match[1]),\n        y: parseInt(match[2])\n      };\n    };\n    const selectedCoords = getGridCoords(selectedLocation.id);\n    if (!selectedCoords) return;\n    setLocations(prev => prev.map(loc => {\n      const coords = getGridCoords(loc.id);\n      if (!coords || loc.discovered) return loc;\n      const dx = Math.abs(coords.x - selectedCoords.x);\n      const dy = Math.abs(coords.y - selectedCoords.y);\n      if (dx <= 1 && dy <= 1) {\n        return {\n          ...loc,\n          discovered: true\n        };\n      }\n      return loc;\n    }));\n    setShowRadialMenu(false);\n  };\n  const purchaseUpgrade = upgrade => {\n    if (upgrade.level >= upgrade.maxLevel) return;\n    const canAfford = Object.entries(upgrade.cost).every(([resource, cost]) => resources[resource] >= (cost || 0));\n    if (canAfford) {\n      setResources(prev => {\n        const newResources = {\n          ...prev\n        };\n        Object.entries(upgrade.cost).forEach(([resource, cost]) => {\n          newResources[resource] -= cost || 0;\n        });\n        return newResources;\n      });\n      setUpgrades(prev => prev.map(u => u.id === upgrade.id ? {\n        ...u,\n        level: u.level + 1,\n        cost: Object.fromEntries(Object.entries(u.cost).map(([r, c]) => [r, Math.floor((c || 0) * 1.5)]))\n      } : u));\n    }\n  };\n  const getScavengeProgress = location => {\n    if (!location.lastScavenged || location.scavengeTime === 0) return 0;\n    const elapsed = Date.now() - location.lastScavenged;\n    return Math.min(100, elapsed / location.scavengeTime * 100);\n  };\n  const attackLocation = location => {\n    const success = Math.random() < 0.7; // Increased to 70% chance of success\n\n    if (success) {\n      const materialsGained = 20 + Math.floor(Math.random() * 30);\n      setResources(prev => ({\n        ...prev,\n        materials: prev.materials + materialsGained\n      }));\n      setLocations(prev => prev.map(loc => loc.id === location.id ? {\n        ...loc,\n        owner: \"player\"\n      } : loc));\n      setShowAttackResult({\n        success: true,\n        locationName: location.name,\n        resourcesGained: {\n          materials: materialsGained\n        }\n      });\n      setShowAttackedAnimation(location.id); // Trigger red square animation\n    } else {\n      const survivorsLost = 1; // Always lose 1 survivor on failure\n      setResources(prev => ({\n        ...prev,\n        survivors: Math.max(0, prev.survivors - survivorsLost)\n      }));\n      setShowAttackResult({\n        success: false,\n        locationName: location.name,\n        survivorsLost: survivorsLost\n      });\n    }\n    setShowRadialMenu(false);\n  };\n  const buyBackLocation = location => {\n    const cost = {\n      materials: 50\n    }; // Example cost\n\n    const canAfford = Object.entries(cost).every(([resource, amount]) => resources[resource] >= (amount || 0));\n    if (canAfford) {\n      setResources(prev => {\n        const newResources = {\n          ...prev\n        };\n        Object.entries(cost).forEach(([resource, amount]) => {\n          newResources[resource] -= amount || 0;\n        });\n        return newResources;\n      });\n      setLocations(prev => prev.map(loc => loc.id === location.id ? {\n        ...loc,\n        owner: \"player\"\n      } : loc));\n      setShowAttackedAnimation(location.id); // Trigger red square animation\n      setShowRadialMenu(false);\n    } else {\n      // Optionally, add feedback for not being able to afford\n      console.log(\"Cannot afford to buy back this location.\");\n    }\n  };\n\n  // Add new state for first time user\n  const [isFirstTimeUser, setIsFirstTimeUser] = useState(() => {\n    const savedGame = localStorage.getItem(SAVE_KEY);\n    return !savedGame;\n  });\n\n  // Add new state for game over\n  const [isGameOver, setIsGameOver] = useState(false);\n\n  // Update startNewGame function\n  const startNewGame = () => {\n    setResources(initialResources);\n    setUpgrades(upgrades.map(upgrade => ({\n      ...upgrade,\n      level: 0\n    })));\n    setLocations(generateInitialGrid());\n    setBuildings([]);\n    setIsGameOver(false);\n    setIsFirstTimeUser(false);\n    setShowDisaster(null);\n    setShowAttackResult(null);\n    setShowAIAttack(null);\n    setScavengeResult(null);\n    setWaitingForScavengePopup(false);\n    setShowAttackedAnimation(null);\n    setSelectedLocation(null);\n    setShowRadialMenu(false);\n    localStorage.removeItem(SAVE_KEY); // Clear saved game from localStorage\n  };\n\n  // Clear attacked animation after a duration\n  useEffect(() => {\n    if (showAttackedAnimation) {\n      const timer = setTimeout(() => {\n        setShowAttackedAnimation(null);\n      }, 1500); // Animation duration\n      return () => clearTimeout(timer);\n    }\n  }, [showAttackedAnimation]);\n\n  // Update GameOver component\n  const GameOver = () => {\n    if (!isGameOver) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4 pointer-events-auto\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative bg-gray-900 border border-red-700 rounded-xl p-8 max-w-md shadow-2xl text-center animate-fade-in\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-4xl font-bold text-red-500 mb-6 drop-shadow-md\",\n          children: \"Game Over\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 830,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-200 text-lg mb-8\",\n          children: \"All your survivors have perished. The wasteland has claimed another settlement.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 833,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: startNewGame,\n            className: \"w-full px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md bg-gradient-to-r from-green-600 to-green-800 hover:from-green-700 hover:to-green-900 text-white\",\n            children: \"Start New Game\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 837,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 836,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 829,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 828,\n      columnNumber: 7\n    }, this);\n  };\n\n  // Update NewGame component\n  const NewGame = () => {\n    if (!isFirstTimeUser) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4 pointer-events-auto\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative bg-gray-900 border border-blue-700 rounded-xl p-8 max-w-md shadow-2xl text-center animate-fade-in\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-4xl font-bold text-blue-500 mb-6 drop-shadow-md\",\n          children: \"Welcome to Wasteland Survivor\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 856,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-200 text-lg mb-8\",\n          children: \"Lead your survivors through the post-apocalyptic wasteland. Gather resources, expand your territory, and survive against all odds.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 859,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: startNewGame,\n            className: \"w-full px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-700 hover:to-blue-900 text-white\",\n            children: \"Start New Game\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 863,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 862,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 855,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 854,\n      columnNumber: 7\n    }, this);\n  };\n\n  // Update popup components to remove pointer-events-none\n  const ScavengePopup = () => {\n    if (!scavengeResult) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative bg-gray-900 border border-gray-700 rounded-xl p-8 max-w-sm shadow-2xl text-center animate-fade-in\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-3xl font-bold text-green-500 mb-4 drop-shadow-md\",\n          children: \"Resources Found!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 882,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"text-gray-200 text-lg space-y-2 mb-6\",\n          children: Object.entries(scavengeResult).map(([key, value]) => value > 0 ? /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"flex items-center justify-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"capitalize mr-2\",\n              children: [key, \":\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 889,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-semibold text-white text-2xl\",\n              children: value\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 890,\n              columnNumber: 19\n            }, this)]\n          }, key, true, {\n            fileName: _jsxFileName,\n            lineNumber: 888,\n            columnNumber: 17\n          }, this) : null)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 885,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            setScavengeResult(null);\n            setWaitingForScavengePopup(false); // Enables next scavenge\n          },\n          className: \"w-full px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md bg-gradient-to-r from-green-600 to-green-800 hover:from-green-700 hover:to-green-900 text-white\",\n          children: \"Continue\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 895,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 881,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 880,\n      columnNumber: 7\n    }, this);\n  };\n  const DisasterPopup = () => {\n    if (!showDisaster) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative bg-gray-900 border border-red-700 rounded-xl p-8 max-w-sm shadow-2xl text-center animate-fade-in\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-3xl font-bold text-red-500 mb-4 drop-shadow-md\",\n          children: showDisaster.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 915,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-200 text-lg mb-6\",\n          children: showDisaster.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 918,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-lg text-gray-300 space-y-2 mb-6\",\n          children: Object.entries(showDisaster.effect).map(([resource, amount]) => /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"flex items-center justify-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"capitalize mr-2\",\n              children: [resource, \":\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 922,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-semibold text-white text-2xl\",\n              children: amount\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 923,\n              columnNumber: 17\n            }, this)]\n          }, resource, true, {\n            fileName: _jsxFileName,\n            lineNumber: 921,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 919,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowDisaster(null),\n          className: \"w-full px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md bg-gradient-to-r from-red-600 to-red-800 hover:from-red-700 hover:to-red-900 text-white\",\n          children: \"Continue\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 927,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 914,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 913,\n      columnNumber: 7\n    }, this);\n  };\n  const AttackResultPopup = () => {\n    if (!showAttackResult) return null;\n    const isSuccess = showAttackResult.success;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `relative bg-gray-900 border ${isSuccess ? \"border-green-700\" : \"border-red-700\"} rounded-xl p-8 max-w-sm shadow-2xl text-center animate-fade-in`,\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: `text-3xl font-bold ${isSuccess ? \"text-green-500\" : \"text-red-500\"} mb-4 drop-shadow-md`,\n          children: isSuccess ? \"Attack Successful!\" : \"Attack Failed!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 946,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-200 text-lg mb-6\",\n          children: isSuccess ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [\"You successfully took over the \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-semibold\",\n              children: showAttackResult.locationName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 952,\n              columnNumber: 48\n            }, this), \"! You gained:\"]\n          }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [\"Your attack on \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-semibold\",\n              children: showAttackResult.locationName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 956,\n              columnNumber: 32\n            }, this), \" failed! You lost:\"]\n          }, void 0, true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 949,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"text-gray-200 text-lg space-y-2 mb-6\",\n          children: [isSuccess && showAttackResult.resourcesGained ? Object.entries(showAttackResult.resourcesGained).map(([key, value]) => value && value > 0 ? /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"flex items-center justify-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"capitalize mr-2\",\n              children: [key, \":\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 965,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-semibold text-white text-2xl\",\n              children: value\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 966,\n              columnNumber: 21\n            }, this)]\n          }, key, true, {\n            fileName: _jsxFileName,\n            lineNumber: 964,\n            columnNumber: 19\n          }, this) : null) : null, !isSuccess && showAttackResult.survivorsLost ? /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"flex items-center justify-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"capitalize mr-2\",\n              children: \"Survivors:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 973,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-semibold text-white text-2xl\",\n              children: showAttackResult.survivorsLost\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 974,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 972,\n            columnNumber: 15\n          }, this) : null]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 960,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowAttackResult(null),\n          className: `w-full px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md ${isSuccess ? \"bg-gradient-to-r from-green-600 to-green-800 hover:from-green-700 hover:to-green-900 text-white\" : \"bg-gradient-to-r from-red-600 to-red-800 hover:from-red-700 hover:to-red-900 text-white\"}\n            `,\n          children: \"Continue\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 978,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 945,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 944,\n      columnNumber: 7\n    }, this);\n  };\n  const AIAttackPopup = () => {\n    if (!showAIAttack) return null;\n    const isSuccess = showAIAttack.success;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `relative bg-gray-900 border ${isSuccess ? \"border-green-700\" : \"border-red-700\"} rounded-xl p-8 max-w-sm shadow-2xl text-center animate-fade-in`,\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: `text-3xl font-bold ${isSuccess ? \"text-green-500\" : \"text-red-500\"} mb-4 drop-shadow-md`,\n          children: isSuccess ? \"Rival Clan Attack Successful!\" : \"Rival Clan Attack Failed!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1000,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-200 text-lg mb-6\",\n          children: isSuccess ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [\"AI successfully took over the \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-semibold\",\n              children: showAIAttack.locationName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1006,\n              columnNumber: 47\n            }, this), \"! You lost:\"]\n          }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [\"AI attack on \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-semibold\",\n              children: showAIAttack.locationName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1010,\n              columnNumber: 30\n            }, this), \" failed! You lost:\"]\n          }, void 0, true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1003,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"text-gray-200 text-lg space-y-2 mb-6\",\n          children: isSuccess && showAIAttack.survivorsLost ? /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"flex items-center justify-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"capitalize mr-2\",\n              children: \"Survivors:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1017,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-semibold text-white text-2xl\",\n              children: showAIAttack.survivorsLost\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1018,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1016,\n            columnNumber: 15\n          }, this) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1014,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowAIAttack(null),\n          className: `w-full px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md ${isSuccess ? \"bg-gradient-to-r from-green-600 to-green-800 hover:from-green-700 hover:to-green-900 text-white\" : \"bg-gradient-to-r from-red-600 to-red-800 hover:from-red-700 hover:to-red-900 text-white\"}\n            `,\n          children: \"Continue\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1022,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 999,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 998,\n      columnNumber: 7\n    }, this);\n  };\n\n  // Update MapView to use built-in animation\n  const MapView = ({\n    buildings,\n    availableBuildings,\n    setBuildings,\n    setResources,\n    locations,\n    showAttackedAnimation\n  }) => {\n    const handleDragOver = e => {\n      e.preventDefault(); // Allow dropping\n    };\n    const handleDrop = (e, locationId) => {\n      e.preventDefault();\n      const buildingId = e.dataTransfer.getData(\"buildingId\");\n      const buildingBlueprint = availableBuildings.find(b => b.id === buildingId);\n      const targetLocation = locations.find(loc => loc.id === locationId);\n      if (!buildingBlueprint || !targetLocation) return;\n\n      // Check if location is valid for building (player-owned, not base, no existing building)\n      const isLocationOccupied = buildings.some(b => b.locationId === locationId);\n      if (!targetLocation.discovered || targetLocation.owner !== \"player\" || targetLocation.isBase || isLocationOccupied) {\n        console.log(\"Cannot place building here.\");\n        return;\n      }\n\n      // Check if player can afford the building\n      const canAfford = Object.entries(buildingBlueprint.cost).every(([resource, cost]) => resources[resource] >= (cost || 0));\n      if (!canAfford) {\n        console.log(\"Cannot afford this building.\");\n        return;\n      }\n\n      // Deduct resources\n      setResources(prev => {\n        const newResources = {\n          ...prev\n        };\n        Object.entries(buildingBlueprint.cost).forEach(([resource, cost]) => {\n          newResources[resource] -= cost || 0;\n        });\n        return newResources;\n      });\n\n      // Add building to state\n      const newBuilding = {\n        ...buildingBlueprint,\n        id: `${buildingBlueprint.type}-${Date.now()}`,\n        // Unique ID for placed building\n        locationId: locationId\n      };\n      setBuildings(prev => [...prev, newBuilding]);\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative bg-gray-900 border border-gray-700 rounded-xl p-8 shadow-2xl h-full flex flex-col overflow-hidden before:absolute before:inset-0 before:bg-gradient-to-br before:from-gray-800 before:via-gray-900 before:to-black before:opacity-50 before:rounded-xl\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"relative z-10 text-4xl font-extrabold text-white mb-8 text-center drop-shadow-md font-display\",\n        children: \"Wasteland Map\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1101,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative z-10 grid bg-gray-950 border border-gray-700 rounded-lg aspect-square shadow-inner overflow-hidden\",\n        style: {\n          gridTemplateColumns: `repeat(${GRID_SIZE}, 1fr)`,\n          gridTemplateRows: `repeat(${GRID_SIZE}, 1fr)`\n        },\n        onClick: () => setShowRadialMenu(false),\n        children: locations.map(location => {\n          const isAnimatingTakeover = showAttackedAnimation === location.id;\n          const placedBuilding = buildings.find(b => b.locationId === location.id);\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `relative flex items-center justify-center p-1 transition-all duration-300 group ${location.discovered ? \"cursor-pointer\" : \"opacity-30\"} ${isAnimatingTakeover ? 'animate-pulse' : ''} ${location.id === showAttackedAnimation ? 'border-4 border-red-500 animate-pulse-fast' : ''}`,\n            onClick: e => handleMapClick(e, location),\n            onDragOver: handleDragOver // Enable drag over\n            ,\n            onDrop: e => handleDrop(e, location.id) // Handle drop\n            ,\n            children: location.discovered ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative w-full h-full flex flex-col items-center justify-center text-center rounded-md overflow-hidden shadow-md group-hover:shadow-lg transition-shadow duration-300 border-2 border-transparent group-hover:border-blue-500\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: `w-full h-full flex items-center justify-center text-4xl transform transition-all duration-300 group-hover:scale-105 ${location.isBase || location.owner === \"player\" ? \"bg-green-700\" : \"bg-blue-700\"}`,\n                children: placedBuilding ? placedBuilding.imageUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: placedBuilding.imageUrl,\n                  alt: placedBuilding.name,\n                  className: \"w-10 h-10 object-contain mx-auto\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1131,\n                  columnNumber: 27\n                }, this) : /*#__PURE__*/_jsxDEV(BaseIcon, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1133,\n                  columnNumber: 27\n                }, this) : location.isBase ? /*#__PURE__*/_jsxDEV(BaseIcon, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1137,\n                  columnNumber: 27\n                }, this) : location.owner === \"player\" ? /*#__PURE__*/_jsxDEV(ResourcesIcon, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1139,\n                  columnNumber: 27\n                }, this) : location.resources && Object.values(location.resources).some(val => val && val > 0) ? /*#__PURE__*/_jsxDEV(ResourcesIcon, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1141,\n                  columnNumber: 27\n                }, this) : null\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1126,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute bottom-0 left-0 right-0 bg-gray-800 bg-opacity-80 p-1 text-center backdrop-blur-sm group-hover:bg-opacity-90 transition-opacity\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs font-semibold text-gray-200 truncate font-display\",\n                  children: location.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1146,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1145,\n                columnNumber: 21\n              }, this), location.lastScavenged && location.scavengeTime > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"absolute top-0 left-0 right-0 h-1 bg-gray-700 rounded-t\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"h-full bg-yellow-500 rounded-t transition-all duration-1000\",\n                  style: {\n                    width: `${getScavengeProgress(location)}%`\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1152,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1151,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1125,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-full h-full rounded-md bg-gray-800 flex items-center justify-center text-4xl opacity-50 animate-pulse border border-gray-700\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1160,\n              columnNumber: 19\n            }, this)\n          }, location.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1117,\n            columnNumber: 15\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1104,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1100,\n      columnNumber: 7\n    }, this);\n  };\n\n  // Components\n  const ResourcePanel = /*#__PURE__*/React.memo(({\n    resources,\n    upgrades,\n    autoScavengeEnabled,\n    purchaseUpgrade,\n    setAutoScavengeEnabled,\n    availableBuildings\n  }) => {\n    const onDragStart = (e, buildingId) => {\n      e.dataTransfer.setData(\"buildingId\", buildingId);\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative bg-gray-900 border border-gray-700 rounded-xl p-8 shadow-2xl h-full flex flex-col overflow-hidden before:absolute before:inset-0 before:bg-gradient-to-br before:from-gray-800 before:via-gray-900 before:to-black before:opacity-50 before:rounded-xl\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative z-10 flex-none\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-4xl font-extrabold text-white mb-8 text-center drop-shadow-md font-display\",\n          children: \"Resources\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1194,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-2 lg:grid-cols-4 gap-6 mb-10\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative bg-gray-800 bg-opacity-70 backdrop-filter backdrop-blur-sm rounded-lg p-5 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-700 flex flex-col items-center justify-center space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(FoodIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1199,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-lg font-bold text-gray-100 font-display\",\n              children: \"Food\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1200,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-3xl font-semibold text-green-400 font-mono\",\n              children: Math.floor(resources.food)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1201,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1198,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative bg-gray-800 bg-opacity-70 backdrop-filter backdrop-blur-sm rounded-lg p-5 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-700 flex flex-col items-center justify-center space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(WaterIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1206,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-lg font-bold text-gray-100 font-display\",\n              children: \"Water\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1207,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-3xl font-semibold text-blue-400 font-mono\",\n              children: Math.floor(resources.water)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1208,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1205,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative bg-gray-800 bg-opacity-70 backdrop-filter backdrop-blur-sm rounded-lg p-5 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-700 flex flex-col items-center justify-center space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(MaterialsIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1213,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-lg font-bold text-gray-100 font-display\",\n              children: \"Materials\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1214,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-3xl font-semibold text-orange-400 font-mono\",\n              children: Math.floor(resources.materials)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1215,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1212,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative bg-gray-800 bg-opacity-70 backdrop-filter backdrop-blur-sm rounded-lg p-5 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-700 flex flex-col items-center justify-center space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(SurvivorsIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1220,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-lg font-bold text-gray-100 font-display\",\n              children: \"Survivors\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1221,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-3xl font-semibold text-purple-400 font-mono\",\n              children: resources.survivors\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1222,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1219,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1197,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-3xl font-bold text-white mb-6 text-center drop-shadow-md\",\n          children: \"Base Upgrades\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1227,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1193,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative z-10 flex-grow overflow-y-auto pr-4 -mr-4\",\n        children: [\" \", /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: upgrades.map(upgrade => {\n            const canAfford = Object.entries(upgrade.cost).every(([resource, cost]) => resources[resource] >= (cost || 0));\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-gray-800 bg-opacity-60 backdrop-filter backdrop-blur-sm rounded-xl p-5 shadow-lg flex flex-col md:flex-row items-center gap-4 border border-gray-700 hover:shadow-xl transition-shadow\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-grow text-center md:text-left\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex flex-col md:flex-row items-center gap-2 mb-1\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                    className: \"text-xl font-semibold text-white\",\n                    children: upgrade.name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1247,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-sm text-green-300\",\n                    children: upgrade.effect\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1250,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1246,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm text-gray-300 mb-2\",\n                  children: upgrade.description\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1254,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-md font-medium text-gray-200\",\n                  children: [\"Level \", upgrade.level, \"/\", upgrade.maxLevel]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1257,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1245,\n                columnNumber: 21\n              }, this), upgrade.level < upgrade.maxLevel && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => purchaseUpgrade(upgrade),\n                disabled: !canAfford,\n                className: `w-full md:w-auto px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md ${canAfford ? \"bg-gradient-to-r from-green-600 to-green-800 hover:from-green-700 hover:to-green-900 text-white\" : \"bg-gray-600 text-gray-400 cursor-not-allowed opacity-70\"}`,\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"Upgrade\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1271,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs mt-1 opacity-80\",\n                  children: [\"(\", Object.entries(upgrade.cost).map(([r, c]) => `${c} ${r}`).join(\", \"), \")\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1272,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1262,\n                columnNumber: 23\n              }, this)]\n            }, upgrade.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1241,\n              columnNumber: 19\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1233,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-3xl font-bold text-white mt-10 mb-6 text-center drop-shadow-md\",\n          children: \"Available Buildings\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1286,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-2 gap-4\",\n          children: availableBuildings.map(building => {\n            const canAffordBuilding = Object.entries(building.cost).every(([resource, cost]) => resources[resource] >= (cost || 0));\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              draggable: true,\n              onDragStart: e => onDragStart(e, building.id),\n              className: `bg-gray-800 bg-opacity-60 backdrop-filter backdrop-blur-sm rounded-xl p-4 shadow-lg flex flex-col items-center text-center border border-gray-700 transition-all duration-300\n                      ${canAffordBuilding ? \"cursor-grab active:cursor-grabbing hover:shadow-xl\" : \"opacity-50 cursor-not-allowed\"}\n                    `,\n              children: [building.imageUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n                src: building.imageUrl,\n                alt: building.name,\n                className: \"w-16 h-16 object-cover mb-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1304,\n                columnNumber: 23\n              }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-4xl mb-2\",\n                children: \"\\uD83C\\uDFD7\\uFE0F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1306,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"text-xl font-semibold text-white mb-1\",\n                children: building.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1308,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-sm text-gray-300 mb-2\",\n                children: [\"Cost: \", Object.entries(building.cost).map(([r, c]) => `${c} ${r}`).join(\", \")]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1309,\n                columnNumber: 21\n              }, this), !canAffordBuilding && /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-red-400 text-xs\",\n                children: \"Cannot afford\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1313,\n                columnNumber: 23\n              }, this)]\n            }, building.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1295,\n              columnNumber: 19\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1289,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1232,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative z-10 flex-none mt-8 pt-6 border-t border-gray-700\",\n        children: /*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"flex items-center justify-center space-x-3 text-gray-300 cursor-pointer\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            checked: autoScavengeEnabled,\n            onChange: e => setAutoScavengeEnabled(e.target.checked),\n            className: \"form-checkbox h-5 w-5 text-green-500 bg-gray-700 border-gray-600 rounded focus:ring-green-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1323,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-lg font-medium text-white\",\n            children: \"Auto-scavenge locations\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1329,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1322,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1321,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative z-10 flex-none mt-8 pt-6 border-t border-gray-700\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: startNewGame,\n          className: \"w-full px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md bg-gradient-to-r from-red-600 to-red-800 hover:from-red-700 hover:to-red-900 text-white\",\n          children: \"Reset Game\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1333,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1332,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1192,\n      columnNumber: 9\n    }, this);\n  });\n\n  // Components\n  const RadialMenu = () => {\n    if (!showRadialMenu || !selectedLocation) return null;\n    const actions = [{\n      label: \"Scavenge\",\n      icon: /*#__PURE__*/_jsxDEV(ResourcesIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1352,\n        columnNumber: 15\n      }, this),\n      enabled: !selectedLocation.lastScavenged && selectedLocation.scavengeTime > 0 && Object.values(selectedLocation.resources).some(val => val && val > 0),\n      action: () => scavengeLocation(selectedLocation)\n    }, {\n      label: \"Attack\",\n      icon: /*#__PURE__*/_jsxDEV(AttackIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1363,\n        columnNumber: 15\n      }, this),\n      enabled: selectedLocation.discovered && !selectedLocation.isBase && selectedLocation.owner !== \"player\",\n      action: () => attackLocation(selectedLocation)\n    }, {\n      label: \"Buy Back\",\n      icon: \"\",\n      enabled: selectedLocation.discovered && !selectedLocation.isBase && selectedLocation.owner !== \"player\" && resources.materials >= 50,\n      action: () => buyBackLocation(selectedLocation),\n      cost: {\n        materials: 50\n      }\n    }, {\n      label: \"Explore\",\n      icon: /*#__PURE__*/_jsxDEV(ExploreIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1383,\n        columnNumber: 15\n      }, this),\n      enabled: resources.materials >= EXPLORATION_COST.materials && resources.survivors >= EXPLORATION_COST.survivors,\n      action: exploreNearby,\n      cost: EXPLORATION_COST\n    }, {\n      label: \"Cancel\",\n      icon: /*#__PURE__*/_jsxDEV(CancelIcon, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1390,\n        columnNumber: 15\n      }, this),\n      enabled: true,\n      action: () => setShowRadialMenu(false)\n    }];\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute\",\n      style: {\n        left: radialMenuPosition.x,\n        top: radialMenuPosition.y\n      },\n      children: actions.map((action, index) => {\n        const angle = (index * 120 - 60) * (Math.PI / 180);\n        const x = Math.cos(angle) * 100;\n        const y = Math.sin(angle) * 100;\n        return /*#__PURE__*/_jsxDEV(\"button\", {\n          disabled: !action.enabled,\n          onClick: e => {\n            e.stopPropagation();\n            action.action();\n          },\n          className: `absolute transform -translate-x-1/2 -translate-y-1/2 w-24 h-24 rounded-full flex flex-col items-center justify-center text-white text-sm font-bold uppercase tracking-wider transition-all duration-300 shadow-xl border-2 ${action.enabled ? \"bg-gradient-to-br from-blue-600 to-blue-800 hover:from-blue-700 hover:to-blue-900 border-blue-500 hover:border-blue-300 transform hover:scale-110\" : \"bg-gray-700 border-gray-600 cursor-not-allowed opacity-60\"}`,\n          style: {\n            left: x,\n            top: y\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-3xl mb-1\",\n            children: action.icon\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1421,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"font-display\",\n            children: action.label\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1422,\n            columnNumber: 15\n          }, this), action.cost && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs mt-1 text-gray-300\",\n            children: [action.cost.materials !== undefined && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"mr-1\",\n                children: /*#__PURE__*/_jsxDEV(MaterialsIcon, {\n                  className: \"h-4 w-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1428,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1427,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"font-mono\",\n                children: action.cost.materials\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1430,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1426,\n              columnNumber: 21\n            }, this), action.cost.survivors !== undefined && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"mr-1\",\n                children: /*#__PURE__*/_jsxDEV(SurvivorsIcon, {\n                  className: \"h-4 w-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1436,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1435,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"font-mono\",\n                children: action.cost.survivors\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1438,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1434,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1424,\n            columnNumber: 17\n          }, this)]\n        }, action.label, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1407,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1397,\n      columnNumber: 7\n    }, this);\n  };\n\n  // Add game over check to the game loop\n  useEffect(() => {\n    if (resources.survivors <= 0 && !isGameOver) {\n      setIsGameOver(true);\n    }\n  }, [resources.survivors, isGameOver]);\n\n  // Add back the triggerAIAttack function\n  const triggerAIAttack = () => {\n    const playerOwnedLocations = locations.filter(loc => loc.owner === \"player\" && !loc.isBase);\n    if (playerOwnedLocations.length > 0) {\n      const targetLocation = playerOwnedLocations[Math.floor(Math.random() * playerOwnedLocations.length)];\n      const success = Math.random() < 0.75; // Increased AI attack success chance\n\n      setShowAttackedAnimation(targetLocation.id); // Trigger red square animation\n\n      if (success) {\n        // AI takes over the location\n        setLocations(prev => prev.map(loc => loc.id === targetLocation.id ? {\n          ...loc,\n          owner: null\n        } : loc));\n        setResources(prev => ({\n          ...prev,\n          survivors: Math.max(0, prev.survivors - 1)\n        }));\n        setShowAIAttack({\n          locationId: targetLocation.id,\n          locationName: targetLocation.name,\n          success: true,\n          survivorsLost: 1\n        });\n      } else {\n        // Player successfully defended\n        setShowAIAttack({\n          locationId: targetLocation.id,\n          locationName: targetLocation.name,\n          success: false\n        });\n      }\n    }\n  };\n\n  // HowToPlay component\n  const HowToPlay = () => {\n    if (!showHowToPlay) return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4 pointer-events-auto\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative bg-gray-900 border border-blue-700 rounded-xl p-8 max-w-2xl shadow-2xl text-center animate-fade-in\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-4xl font-bold text-blue-500 mb-6 drop-shadow-md font-display\",\n          children: \"How to Play\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1505,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-gray-200 text-lg space-y-4 text-left\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Welcome to Wasteland Survivor! Your goal is to lead your group of survivors through a post-apocalyptic world. Here's how to play:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1509,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-xl font-semibold text-blue-300 mt-4\",\n            children: \"Resources:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1512,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Gather Food \\uD83C\\uDF56, Water \\uD83D\\uDCA7, Materials \\uD83D\\uDD27, and manage your Survivors \\uD83D\\uDC65. These are essential for survival and progress.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1513,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-xl font-semibold text-blue-300 mt-4\",\n            children: \"Map & Exploration:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1515,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Click on map locations to open a radial menu. You can Scavenge locations for resources, Attack rival locations to take them over, or Explore nearby to discover new areas. Exploring costs materials and survivors.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1516,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-xl font-semibold text-blue-300 mt-4\",\n            children: \"Buildings:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1518,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"From the Resources panel, you can drag and drop buildings like Houses onto available map squares. Houses provide shelter for your survivors; without enough housing, survivors will freeze and die!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1519,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-xl font-semibold text-blue-300 mt-4\",\n            children: \"Upgrades:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1521,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Invest in base upgrades to increase your resource production and survivor attraction.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1522,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-xl font-semibold text-blue-300 mt-4\",\n            children: \"Threats:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1524,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Beware of random Disasters and Rival Clan attacks. These events can deplete your resources and survivors, so be prepared!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1525,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-xl font-semibold text-blue-300 mt-4\",\n            children: \"Game Over:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1527,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"The game ends if all your survivors are lost. You can always start a new game to try again!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1528,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1508,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowHowToPlay(false),\n          className: \"w-full mt-8 px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-700 hover:to-blue-900 text-white\",\n          children: \"Got It!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1530,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1504,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1503,\n      columnNumber: 7\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-950 text-white font-sans antialiased relative overflow-hidden\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 z-0 opacity-10 pointer-events-none\",\n      style: {\n        backgroundImage: `url('https://www.transparenttextures.com/patterns/dust-and-stones.png')`,\n        backgroundSize: 'cover',\n        backgroundAttachment: 'fixed'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1544,\n      columnNumber: 7\n    }, this), !isGameOver && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: isMobile ?\n      /*#__PURE__*/\n      // Mobile layout with tabs\n      _jsxDEV(\"div\", {\n        className: \"relative z-10 px-4 py-6 h-screen flex flex-col bg-gray-950 bg-opacity-95 pointer-events-auto\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-5xl font-extrabold text-center mb-8 text-white drop-shadow-lg leading-tight font-display\",\n          children: [\"Wasteland\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1560,\n            columnNumber: 17\n          }, this), \"Survivor\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1558,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex mb-6 bg-gray-800 rounded-xl p-1 shadow-inner border border-gray-700\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setActiveTab(\"resources\"),\n            className: `flex-1 py-3 px-4 rounded-lg text-lg font-bold transition-all duration-300 transform hover:scale-105 shadow-md ${activeTab === \"resources\" ? \"bg-gradient-to-r from-blue-600 to-blue-800 text-white\" : \"text-gray-400 hover:text-white hover:bg-gray-700\"}`,\n            children: \"Resources\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1564,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setActiveTab(\"map\"),\n            className: `flex-1 py-3 px-4 rounded-lg text-lg font-bold transition-all duration-300 transform hover:scale-105 shadow-md ${activeTab === \"map\" ? \"bg-gradient-to-r from-blue-600 to-blue-800 text-white\" : \"text-gray-400 hover:text-white hover:bg-gray-700\"}`,\n            children: \"Map\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1573,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1563,\n          columnNumber: 15\n        }, this), activeTab === \"resources\" ? /*#__PURE__*/_jsxDEV(ResourcePanel, {\n          resources: resources,\n          upgrades: upgrades,\n          autoScavengeEnabled: autoScavengeEnabled,\n          purchaseUpgrade: purchaseUpgrade,\n          setAutoScavengeEnabled: setAutoScavengeEnabled,\n          availableBuildings: availableBuildings\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1584,\n          columnNumber: 17\n        }, this) : /*#__PURE__*/_jsxDEV(MapView, {\n          buildings: buildings,\n          availableBuildings: availableBuildings,\n          setBuildings: setBuildings,\n          setResources: setResources,\n          locations: locations,\n          showAttackedAnimation: showAttackedAnimation\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1593,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1557,\n        columnNumber: 13\n      }, this) :\n      /*#__PURE__*/\n      // Desktop split-screen layout\n      _jsxDEV(\"div\", {\n        className: \"relative z-10 flex h-screen p-8 gap-8 bg-gray-950 bg-opacity-95\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-1/2 flex flex-col\",\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"text-5xl font-extrabold mb-8 text-white drop-shadow-lg leading-tight text-center font-display\",\n            children: [\"Wasteland\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1609,\n              columnNumber: 19\n            }, this), \"Survivor\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1607,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(ResourcePanel, {\n            resources: resources,\n            upgrades: upgrades,\n            autoScavengeEnabled: autoScavengeEnabled,\n            purchaseUpgrade: purchaseUpgrade,\n            setAutoScavengeEnabled: setAutoScavengeEnabled,\n            availableBuildings: availableBuildings\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1612,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1606,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-1/2 flex flex-col h-full\",\n          children: /*#__PURE__*/_jsxDEV(MapView, {\n            buildings: buildings,\n            availableBuildings: availableBuildings,\n            setBuildings: setBuildings,\n            setResources: setResources,\n            locations: locations,\n            showAttackedAnimation: showAttackedAnimation\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1622,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1621,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1605,\n        columnNumber: 13\n      }, this)\n    }, void 0, false), !isGameOver && !isFirstTimeUser && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => setShowHowToPlay(true),\n      className: \"fixed bottom-4 right-4 px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md bg-gradient-to-r from-purple-600 to-purple-800 hover:from-purple-700 hover:to-purple-900 text-white z-40\",\n      children: \"How to Play\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1638,\n      columnNumber: 9\n    }, this), (showRadialMenu || showDisaster || scavengeResult || showAttackResult || showAIAttack || isGameOver || isFirstTimeUser || showHowToPlay) && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 z-50 bg-black bg-opacity-70 flex items-center justify-center pointer-events-auto\",\n      onClick: e => {\n        if (e.target === e.currentTarget) {\n          // Only close if clicking the backdrop, not content\n          setShowRadialMenu(false);\n          setShowDisaster(null);\n          setScavengeResult(null);\n          setShowAttackResult(null);\n          setShowAIAttack(null);\n          setShowHowToPlay(false);\n        }\n      },\n      children: [/*#__PURE__*/_jsxDEV(RadialMenu, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1661,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(DisasterPopup, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1662,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(ScavengePopup, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1663,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(AttackResultPopup, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1664,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(AIAttackPopup, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1665,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(GameOver, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1666,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(NewGame, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1667,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(HowToPlay, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1668,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1648,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 1542,\n    columnNumber: 5\n  }, this);\n};\n_s(ApocalypticGame, \"VlEcYSS9nrMlfwEr01kZ/a0i8ok=\");\n_c0 = ApocalypticGame;\nexport default ApocalypticGame;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c0;\n$RefreshReg$(_c, \"FoodIcon\");\n$RefreshReg$(_c2, \"WaterIcon\");\n$RefreshReg$(_c3, \"MaterialsIcon\");\n$RefreshReg$(_c4, \"SurvivorsIcon\");\n$RefreshReg$(_c5, \"BaseIcon\");\n$RefreshReg$(_c6, \"ResourcesIcon\");\n$RefreshReg$(_c7, \"AttackIcon\");\n$RefreshReg$(_c8, \"ExploreIcon\");\n$RefreshReg$(_c9, \"CancelIcon\");\n$RefreshReg$(_c0, \"ApocalypticGame\");","map":{"version":3,"names":["React","useCallback","useEffect","useRef","useState","jsxDEV","_jsxDEV","Fragment","_Fragment","SAVE_KEY","AUTO_SAVE_INTERVAL","DISASTER_CHANCE","AI_ATTACK_CHANCE","HOUSE_CAPACITY","UNHOUSED_SURVIVOR_DEATH_RATE","EXPLORATION_COST","materials","initialResources","food","water","survivors","disasters","id","name","description","effect","FoodIcon","className","xmlns","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","children","d","fileName","_jsxFileName","lineNumber","columnNumber","x1","y1","x2","y2","_c","WaterIcon","_c2","MaterialsIcon","_c3","SurvivorsIcon","cx","cy","r","_c4","BaseIcon","points","_c5","ResourcesIcon","_c6","AttackIcon","_c7","ExploreIcon","_c8","CancelIcon","_c9","ApocalypticGame","_s","resources","setResources","activeTab","setActiveTab","isMobile","setIsMobile","showRadialMenu","setShowRadialMenu","radialMenuPosition","setRadialMenuPosition","x","y","selectedLocation","setSelectedLocation","showDisaster","setShowDisaster","autoScavengeEnabled","setAutoScavengeEnabled","buildings","setBuildings","scavengeResult","setScavengeResult","showAttackResult","setShowAttackResult","showAIAttack","setShowAIAttack","showAttackedAnimation","setShowAttackedAnimation","showHowToPlay","setShowHowToPlay","waitingForScavengePopup","setWaitingForScavengePopup","gameLoopRef","autoSaveRef","upgrades","setUpgrades","cost","level","maxLevel","GRID_SIZE","locationNames","generateInitialGrid","locations","isBase","Math","floor","push","discovered","scavengeTime","random","lastScavenged","owner","setLocations","availableBuildings","type","imageUrl","resourcesRef","upgradesRef","current","checkMobile","window","innerWidth","addEventListener","removeEventListener","savedGame","localStorage","getItem","gameState","JSON","parse","timePassed","Date","now","lastSave","minutesPassed","offlineResources","forEach","upgrade","e","console","error","saveGame","setItem","stringify","setInterval","clearInterval","floorResources","res","isEqualResources","a","b","prev","newResources","totalHousingCapacity","filter","length","unhousedSurvivors","lostSurvivors","min","ceil","max","floored","disaster","applyDisaster","triggerAIAttack","checkAutoScavenge","interval","finished","find","loc","finalizeScavenge","hasActiveScavenge","updated","newLocations","map","loot","targetIndex","findIndex","Object","values","some","v","location","prevResources","wasScavenged","handleMapClick","stopPropagation","clientX","clientY","scavengeLocation","exploreNearby","canAfford","entries","every","resource","amount","success","locationName","survivorsLost","getGridCoords","match","parseInt","selectedCoords","coords","dx","abs","dy","purchaseUpgrade","u","fromEntries","c","getScavengeProgress","elapsed","attackLocation","materialsGained","resourcesGained","buyBackLocation","log","isFirstTimeUser","setIsFirstTimeUser","isGameOver","setIsGameOver","startNewGame","removeItem","timer","setTimeout","clearTimeout","GameOver","onClick","NewGame","ScavengePopup","key","value","DisasterPopup","AttackResultPopup","isSuccess","AIAttackPopup","MapView","handleDragOver","preventDefault","handleDrop","locationId","buildingId","dataTransfer","getData","buildingBlueprint","targetLocation","isLocationOccupied","newBuilding","style","gridTemplateColumns","gridTemplateRows","isAnimatingTakeover","placedBuilding","onDragOver","onDrop","src","alt","val","width","ResourcePanel","memo","onDragStart","setData","disabled","join","building","canAffordBuilding","draggable","checked","onChange","target","RadialMenu","actions","label","icon","enabled","action","left","top","index","angle","PI","cos","sin","undefined","playerOwnedLocations","HowToPlay","backgroundImage","backgroundSize","backgroundAttachment","currentTarget","_c0","$RefreshReg$"],"sources":["/Users/faybennett/outlierTasks/game-app/src/App.tsx"],"sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from \"react\";\n\n// Types\ninterface Resources {\n  food: number;\n  water: number;\n  materials: number;\n  survivors: number;\n}\n\ninterface BaseUpgrade {\n  id: string;\n  name: string;\n  description: string;\n  cost: Partial<Resources>;\n  effect: string;\n  level: number;\n  maxLevel: number;\n}\n\ninterface MapLocation {\n  id: string;\n  name: string;\n  x: number;\n  y: number;\n  discovered: boolean;\n  scavengeTime: number;\n  lastScavenged: number | null;\n  resources: Partial<Resources>;\n  isBase?: boolean; // Optional property to mark the base location\n  wasScavenged?: boolean; // Optional property to track if the location was already scavenged\n  owner?: string | null; // New property to track ownership\n}\n\ninterface Building {\n  id: string;\n  type: \"house\" | \"water_collector\"; // Define building types\n  locationId?: string; // The ID of the MapLocation this building is on (optional, for blueprints)\n  level: number;\n  imageUrl?: string; // Optional image URL for visual representation\n  name: string; // Added name property\n  cost: Partial<Resources>; // Added cost property\n}\n\ninterface Disaster {\n  id: string;\n  name: string;\n  description: string;\n  effect: Partial<Resources>;\n}\n\ninterface AIAttack {\n  locationId: string;\n  locationName: string;\n  success: boolean;\n  resourcesLost?: Partial<Resources>;\n  survivorsLost?: number;\n}\n\ninterface RadialMenuAction {\n  label: string;\n  icon: JSX.Element | string;\n  enabled: boolean;\n  action: () => void;\n  cost?: Partial<Resources>;\n}\n\ninterface GameState {\n  resources: Resources;\n  upgrades: BaseUpgrade[];\n  locations: MapLocation[];\n  lastSave: number;\n  autoScavengeEnabled: boolean;\n}\n\n// Constants\nconst SAVE_KEY = \"apocalypse-idle-save\";\nconst AUTO_SAVE_INTERVAL = 10000; // 10 secon\nconst DISASTER_CHANCE = 0.002;\nconst AI_ATTACK_CHANCE = 0.02; \nconst HOUSE_CAPACITY = 2;\nconst UNHOUSED_SURVIVOR_DEATH_RATE = 0.01;\nconst EXPLORATION_COST = { \n  materials: 20,\n};\n\nconst initialResources: Resources = {\n  food: 100,\n  water: 100,\n  materials: 50,\n  survivors: 5,\n};\n\nconst disasters: Disaster[] = [\n  {\n    id: \"raiders\",\n    name: \"Raider Attack!\",\n    description: \"Raiders have attacked your base!\",\n    effect: { food: -20, water: -15, materials: -10 },\n  },\n  {\n    id: \"drought\",\n    name: \"Drought\",\n    description: \"Water supplies are running low!\",\n    effect: { water: -30 },\n  },\n  {\n    id: \"sickness\",\n    name: \"Disease Outbreak\",\n    description: \"A disease has spread through your camp!\",\n    effect: { survivors: -1, food: -10 },\n  },\n];\n\n// Update icon components to accept className props\nconst FoodIcon = ({ className = \"h-8 w-8\" }: { className?: string }) => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M18 8h1a4 4 0 0 1 0 8h-1\"></path>\n    <path d=\"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z\"></path>\n    <line x1=\"6\" y1=\"1\" x2=\"6\" y2=\"4\"></line>\n    <line x1=\"10\" y1=\"1\" x2=\"10\" y2=\"4\"></line>\n    <line x1=\"14\" y1=\"1\" x2=\"14\" y2=\"4\"></line>\n  </svg>\n);\n\nconst WaterIcon = ({ className = \"h-8 w-8\" }: { className?: string }) => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z\"></path>\n  </svg>\n);\n\nconst MaterialsIcon = ({ className = \"h-8 w-8\" }: { className?: string }) => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\"></path>\n  </svg>\n);\n\nconst SurvivorsIcon = ({ className = \"h-8 w-8\" }: { className?: string }) => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"></path>\n    <circle cx=\"9\" cy=\"7\" r=\"4\"></circle>\n    <path d=\"M23 21v-2a4 4 0 0 0-3-3.87\"></path>\n    <path d=\"M16 3.13a4 4 0 0 1 0 7.75\"></path>\n  </svg>\n);\n\nconst BaseIcon = ({ className = \"h-8 w-8\" }: { className?: string }) => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\"></path>\n    <polyline points=\"9 22 9 12 15 12 15 22\"></polyline>\n  </svg>\n);\n\nconst ResourcesIcon = ({ className = \"h-8 w-8\" }: { className?: string }) => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z\"></path>\n    <line x1=\"16\" y1=\"8\" x2=\"2\" y2=\"22\"></line>\n    <line x1=\"17.5\" y1=\"15\" x2=\"9\" y2=\"15\"></line>\n  </svg>\n);\n\nconst AttackIcon = ({ className = \"h-8 w-8\" }: { className?: string }) => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <path d=\"M12 19l7-7 3 3-7 7-3-3z\"></path>\n    <path d=\"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z\"></path>\n    <path d=\"M2 2l7.586 7.586\"></path>\n    <circle cx=\"11\" cy=\"11\" r=\"2\"></circle>\n  </svg>\n);\n\nconst ExploreIcon = ({ className = \"h-8 w-8\" }: { className?: string }) => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n    <polygon points=\"16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76\"></polygon>\n  </svg>\n);\n\nconst CancelIcon = ({ className = \"h-8 w-8\" }: { className?: string }) => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" className={className} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n    <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\n    <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\n  </svg>\n);\n\nconst ApocalypticGame: React.FC = () => {\n  // State\n  const [resources, setResources] = useState<Resources>(initialResources);\n  const [activeTab, setActiveTab] = useState<\"resources\" | \"map\">(\"resources\");\n  const [isMobile, setIsMobile] = useState(false);\n  const [showRadialMenu, setShowRadialMenu] = useState(false);\n  const [radialMenuPosition, setRadialMenuPosition] = useState({ x: 0, y: 0 });\n  const [selectedLocation, setSelectedLocation] = useState<MapLocation | null>(\n    null,\n  );\n  const [showDisaster, setShowDisaster] = useState<Disaster | null>(null);\n  const [autoScavengeEnabled, setAutoScavengeEnabled] = useState(true);\n  const [buildings, setBuildings] = useState<Building[]>([]);\n\n  const [scavengeResult, setScavengeResult] =\n    useState<Partial<Resources> | null>(null);\n  const [showAttackResult, setShowAttackResult] = useState<{ success: boolean; locationName: string; resourcesGained?: Partial<Resources>; survivorsLost?: number } | null>(null);\n  const [showAIAttack, setShowAIAttack] = useState<AIAttack | null>(null); // New state for AI attack results\n  const [showAttackedAnimation, setShowAttackedAnimation] = useState<string | null>(null); // New state for AI attack animation\n  const [showHowToPlay, setShowHowToPlay] = useState(false); // New state for How to Play popup\n\n  const [waitingForScavengePopup, setWaitingForScavengePopup] = useState(false);\n\n  const gameLoopRef = useRef<ReturnType<typeof setInterval> | null>(null);\n  const autoSaveRef = useRef<ReturnType<typeof setInterval> | null>(null);\n\n  const [upgrades, setUpgrades] = useState<BaseUpgrade[]>([\n    {\n      id: \"farm\",\n      name: \"Makeshift Farm\",\n      description: \"Produces food over time\",\n      cost: { materials: 50 },\n      effect: \"+5 food/minute\",\n      level: 0,\n      maxLevel: 5,\n    },\n    {\n      id: \"well\",\n      name: \"Water Collector\",\n      description: \"Collects water from the atmosphere\",\n      cost: { materials: 40 },\n      effect: \"+3 water/minute\",\n      level: 0,\n      maxLevel: 5,\n    },\n    {\n      id: \"shelter\",\n      name: \"Survivor Shelter\",\n      description: \"Attracts new survivors\",\n      cost: { materials: 100, food: 50 },\n      effect: \"+1 survivor chance/hour\",\n      level: 0,\n      maxLevel: 3,\n    },\n  ]);\n\n  const GRID_SIZE = 5;\n\n  const locationNames = [\n    \"Dustfield\",\n    \"Ashrock\",\n    \"Ironpit\",\n    \"Deadwell\",\n    \"Cragpoint\",\n    \"Burnpass\",\n    \"Mudspire\",\n    \"Wretchend\",\n    \"Redhollow\",\n    \"Saltmoor\",\n    \"Scraptown\",\n    \"Charcliff\",\n    \"Dryreach\",\n    \"Ragbank\",\n    \"Blightden\",\n    \"Boneplain\",\n    \"Rustbarrow\",\n    \"Smokefall\",\n    \"Shivglen\",\n    \"Flintgorge\",\n    \"Gravefen\",\n    \"Scorchbay\",\n    \"Fogscar\",\n    \"Ruinstep\",\n    \"Crimsonlot\",\n  ];\n\n  const generateInitialGrid = (): MapLocation[] => {\n    const locations: MapLocation[] = [];\n\n    for (let y = 0; y < GRID_SIZE; y++) {\n      for (let x = 0; x < GRID_SIZE; x++) {\n        const isBase =\n          x === Math.floor(GRID_SIZE / 2) && y === Math.floor(GRID_SIZE / 2);\n\n        locations.push({\n          id: `cell-${x}-${y}`,\n          name: isBase\n            ? \"Your Base\"\n            : locationNames[y * GRID_SIZE + x] || `Sector-${x}-${y}`,\n          isBase: isBase,\n          x,\n          y,\n          discovered: isBase,\n          scavengeTime: isBase ? 0 : 5000 + Math.floor(Math.random() * 5000),\n          lastScavenged: null,\n          resources: isBase\n            ? {}\n            : Math.random() < 0.8 // Increased chance of having resources on newly discovered locations\n            ? {\n                food: Math.floor(Math.random() * 50) + 10, // Increased food range\n                water: Math.floor(Math.random() * 30) + 5, // Increased water range\n                materials:\n                  Math.random() < 0.7 ? Math.floor(Math.random() * 60) + 10 : 0, // Increased material chance and range\n                survivors: Math.random() < 0.3 ? 1 : 0, // Slightly increased survivor chance\n              }\n            : {},\n          owner: isBase ? \"player\" : null, // Set owner for base and null for others\n        });\n      }\n    }\n\n    return locations;\n  };\n\n  const [locations, setLocations] = useState<MapLocation[]>(\n    generateInitialGrid(),\n  );\n\n  const availableBuildings: Building[] = [\n    { id: \"house-blueprint\", type: \"house\", name: \"House\", cost: { materials: 30, food: 10 }, level: 0, imageUrl: \"https://img.icons8.com/ios-filled/50/ffffff/home.png\" },\n    // { id: \"water-collector-blueprint\", type: \"water_collector\", name: \"Water Collector\", cost: { materials: 40 }, imageUrl: \"https://i.imgur.com/your-water-collector-image.png\" },\n  ];\n\n  const resourcesRef = useRef(resources);\n  const upgradesRef = useRef(upgrades);\n\n  // Update refs whenever state changes\n  useEffect(() => {\n    resourcesRef.current = resources;\n  }, [resources]);\n  useEffect(() => {\n    upgradesRef.current = upgrades;\n  }, [upgrades]);\n\n  // Responsive design\n  useEffect(() => {\n    const checkMobile = () => {\n      setIsMobile(window.innerWidth < 768);\n    };\n    checkMobile();\n    window.addEventListener(\"resize\", checkMobile);\n    return () => window.removeEventListener(\"resize\", checkMobile);\n  }, []);\n\n  // Load game\n  useEffect(() => {\n    const savedGame = localStorage.getItem(SAVE_KEY);\n    if (savedGame) {\n      try {\n        const gameState: GameState = JSON.parse(savedGame);\n        const timePassed = Date.now() - gameState.lastSave;\n\n        // Calculate offline progression\n        const minutesPassed = timePassed / 60000;\n        const offlineResources = { ...gameState.resources };\n\n        gameState.upgrades.forEach((upgrade) => {\n          if (upgrade.id === \"farm\" && upgrade.level > 0) {\n            offlineResources.food += Math.floor(\n              minutesPassed * 5 * upgrade.level * 0.5,\n            ); // 50% efficiency offline\n          }\n          if (upgrade.id === \"well\" && upgrade.level > 0) {\n            offlineResources.water += Math.floor(\n              minutesPassed * 3 * upgrade.level * 0.5,\n            );\n          }\n          if (upgrade.id === \"shelter\" && upgrade.level > 0) {\n            offlineResources.survivors += Math.floor(\n              minutesPassed * (1 / 60) * upgrade.level * 0.5,\n            );\n          }\n        });\n\n        setResources(offlineResources);\n        setUpgrades(gameState.upgrades);\n        setLocations(gameState.locations);\n        setAutoScavengeEnabled(gameState.autoScavengeEnabled);\n      } catch (e) {\n        console.error(\"Failed to load save:\", e);\n      }\n    }\n  }, []);\n\n  // Save game\n  const saveGame = useCallback(() => {\n    const gameState: GameState = {\n      resources,\n      upgrades,\n      locations,\n      lastSave: Date.now(),\n      autoScavengeEnabled,\n    };\n    localStorage.setItem(SAVE_KEY, JSON.stringify(gameState));\n  }, [resources, upgrades, locations, autoScavengeEnabled]);\n\n  // Auto save\n  useEffect(() => {\n    autoSaveRef.current = setInterval(saveGame, AUTO_SAVE_INTERVAL);\n    return () => {\n      if (autoSaveRef.current) clearInterval(autoSaveRef.current);\n    };\n  }, [saveGame]);\n\n  function floorResources(res: Resources): Resources {\n    return {\n      food: Math.floor(res.food),\n      water: Math.floor(res.water),\n      materials: Math.floor(res.materials),\n      survivors: Math.floor(res.survivors),\n    };\n  }\n\n  function isEqualResources(a: Resources, b: Resources): boolean {\n    return (\n      a.food === b.food &&\n      a.water === b.water &&\n      a.materials === b.materials &&\n      a.survivors === b.survivors\n    );\n  }\n\n  // Game loop\n  useEffect(() => {\n    gameLoopRef.current = setInterval(() => {\n      setResources((prev) => {\n        const newResources = { ...prev };\n\n        // Apply upgrade effects\n        upgrades.forEach((upgrade) => {\n          if (upgrade.id === \"farm\" && upgrade.level > 0) {\n            newResources.food += (5 * upgrade.level) / 60; // per second\n          }\n          if (upgrade.id === \"well\" && upgrade.level > 0) {\n            newResources.water += (3 * upgrade.level) / 60;\n          }\n          if (upgrade.id === \"shelter\" && upgrade.level > 0) {\n            newResources.survivors += (1 * upgrade.level) / 3600; // 1 per hour\n          }\n        });\n\n        // Housing check: survivors freeze and die if not enough houses\n        const totalHousingCapacity = buildings.filter(b => b.type === \"house\").length * HOUSE_CAPACITY;\n        const unhousedSurvivors = newResources.survivors - totalHousingCapacity;\n        \n        if (unhousedSurvivors > 0 && Math.random() < UNHOUSED_SURVIVOR_DEATH_RATE * unhousedSurvivors) {\n          const lostSurvivors = Math.min(Math.ceil(unhousedSurvivors / 5), newResources.survivors); // Lose a fraction of unhoused survivors or at least 1\n          newResources.survivors = Math.max(0, newResources.survivors - lostSurvivors);\n          setShowDisaster({\n            id: \"exposure\",\n            name: \"Exposure!\",\n            description: `Some of your unhoused survivors froze to death! Lost ${lostSurvivors} survivor(s).`, // Dynamic message\n            effect: { survivors: -lostSurvivors },\n          });\n        }\n\n        // Survivor consumption\n        newResources.food = Math.max(\n          0,\n          newResources.food - prev.survivors * 0.01,\n        );\n        newResources.water = Math.max(\n          0,\n          newResources.water - prev.survivors * 0.02,\n        );\n\n        // Floor and compare\n        const floored = floorResources(newResources);\n        if (!isEqualResources(floored, floorResources(prev))) {\n          return floored;\n        }\n        return prev; // Skip update if unchanged\n      });\n\n      // Check for disasters\n      if (Math.random() < DISASTER_CHANCE) {\n        const disaster =\n          disasters[Math.floor(Math.random() * disasters.length)];\n        setShowDisaster(disaster);\n        applyDisaster(disaster);\n      }\n\n      // Check for AI attacks\n      if (Math.random() < AI_ATTACK_CHANCE) {\n        triggerAIAttack();\n      }\n\n      // Auto scavenging\n      if (autoScavengeEnabled) {\n        checkAutoScavenge();\n      }\n    }, 2000);\n\n    return () => {\n      if (gameLoopRef.current) clearInterval(gameLoopRef.current);\n    };\n  }, [upgrades, autoScavengeEnabled]);\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      const now = Date.now();\n      if (waitingForScavengePopup || scavengeResult) return;\n\n      const finished = locations.find(\n        (loc) =>\n          loc.lastScavenged &&\n          loc.scavengeTime > 0 &&\n          now - loc.lastScavenged >= loc.scavengeTime,\n      );\n\n      if (finished) finalizeScavenge(finished);\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [locations, waitingForScavengePopup, scavengeResult]);\n\n  const applyDisaster = (disaster: Disaster) => {\n    setResources((prev) => ({\n      food: Math.max(0, prev.food + (disaster.effect.food || 0)),\n      water: Math.max(0, prev.water + (disaster.effect.water || 0)),\n      materials: Math.max(0, prev.materials + (disaster.effect.materials || 0)),\n      survivors: Math.max(1, prev.survivors + (disaster.effect.survivors || 0)),\n    }));\n  };\n\n  const checkAutoScavenge = () => {\n    if (waitingForScavengePopup) return;\n\n    const now = Date.now();\n\n    setLocations((prev) => {\n      let hasActiveScavenge = false;\n      let updated = false;\n\n      const newLocations = prev.map((loc) => {\n        if (loc.lastScavenged && loc.scavengeTime > 0) {\n          if (now - loc.lastScavenged >= loc.scavengeTime && !updated) {\n            const loot = {\n              food: loc.resources.food || 0,\n              water: loc.resources.water || 0,\n              materials: loc.resources.materials || 0,\n              survivors: loc.resources.survivors || 0,\n            };\n\n            finalizeScavenge(loc);\n            updated = true;\n            return loc;\n          }\n\n          hasActiveScavenge = true;\n          return loc;\n        }\n\n        return loc;\n      });\n\n      if (!hasActiveScavenge && !updated) {\n        // Start auto-scavenge on the first available location\n        const targetIndex = newLocations.findIndex(\n          (loc) =>\n            loc.discovered &&\n            !loc.lastScavenged &&\n            loc.scavengeTime > 0 &&\n            Object.values(loc.resources).some((v) => v && v > 0),\n        );\n\n        if (targetIndex !== -1) {\n          newLocations[targetIndex] = {\n            ...newLocations[targetIndex],\n            lastScavenged: now,\n          };\n          updated = true;\n        }\n      }\n\n      return newLocations;\n    });\n  };\n\n  const finalizeScavenge = (location: MapLocation) => {\n    const loot = {\n      food: location.resources.food || 0,\n      water: location.resources.water || 0,\n      materials: location.resources.materials || 0,\n      survivors: location.resources.survivors || 0,\n    };\n\n    setScavengeResult(loot);\n    setResources((prevResources) => ({\n      food: prevResources.food + loot.food,\n      water: prevResources.water + loot.water,\n      materials: prevResources.materials + loot.materials,\n      survivors: prevResources.survivors + loot.survivors,\n    }));\n    setWaitingForScavengePopup(true);\n\n    setLocations((prev) =>\n      prev.map((loc) =>\n        loc.id === location.id\n          ? { ...loc, lastScavenged: null, resources: {}, wasScavenged: true }\n          : loc,\n      ),\n    );\n  };\n\n  const handleMapClick = (\n    e: React.MouseEvent<HTMLDivElement>,\n    location: MapLocation,\n  ) => {\n    e.stopPropagation();\n    if (!location.discovered && location.id !== \"base\") return;\n\n    setSelectedLocation(location);\n    setRadialMenuPosition({ x: e.clientX, y: e.clientY });\n    setShowRadialMenu(true);\n  };\n\n  const scavengeLocation = (location: MapLocation) => {\n    if (location.lastScavenged || location.scavengeTime === 0) return;\n\n    setLocations((prev) =>\n      prev.map((loc) =>\n        loc.id === location.id ? { ...loc, lastScavenged: Date.now() } : loc,\n      ),\n    );\n    setShowRadialMenu(false);\n  };\n\n  const exploreNearby = () => {\n    if (!selectedLocation) return;\n\n    const cost = EXPLORATION_COST;\n    const canAfford = Object.entries(cost).every(\n      ([resource, amount]) => resources[resource as keyof Resources] >= (amount || 0)\n    );\n\n    if (!canAfford) {\n      // Show a message that you can't afford to explore\n      setShowAttackResult({\n        success: false,\n        locationName: \"Exploration\",\n        survivorsLost: 0,\n      });\n      setShowRadialMenu(false);\n      return;\n    }\n\n    // Deduct cost\n    setResources(prev => {\n      const newResources = { ...prev };\n      Object.entries(cost).forEach(([resource, amount]) => {\n        newResources[resource as keyof Resources] -= amount || 0;\n      });\n      return newResources;\n    });\n\n    const getGridCoords = (id: string) => {\n      const match = id.match(/cell-(\\d+)-(\\d+)/);\n      if (!match) return null;\n      return { x: parseInt(match[1]), y: parseInt(match[2]) };\n    };\n\n    const selectedCoords = getGridCoords(selectedLocation.id);\n    if (!selectedCoords) return;\n\n    setLocations((prev) =>\n      prev.map((loc) => {\n        const coords = getGridCoords(loc.id);\n        if (!coords || loc.discovered) return loc;\n\n        const dx = Math.abs(coords.x - selectedCoords.x);\n        const dy = Math.abs(coords.y - selectedCoords.y);\n\n        if (dx <= 1 && dy <= 1) {\n          return { ...loc, discovered: true };\n        }\n\n        return loc;\n      }),\n    );\n\n    setShowRadialMenu(false);\n  };\n\n  const purchaseUpgrade = (upgrade: BaseUpgrade) => {\n    if (upgrade.level >= upgrade.maxLevel) return;\n\n    const canAfford = Object.entries(upgrade.cost).every(\n      ([resource, cost]) =>\n        resources[resource as keyof Resources] >= (cost || 0),\n    );\n\n    if (canAfford) {\n      setResources((prev) => {\n        const newResources = { ...prev };\n        Object.entries(upgrade.cost).forEach(([resource, cost]) => {\n          newResources[resource as keyof Resources] -= cost || 0;\n        });\n        return newResources;\n      });\n\n      setUpgrades((prev) =>\n        prev.map((u) =>\n          u.id === upgrade.id\n            ? {\n                ...u,\n                level: u.level + 1,\n                cost: Object.fromEntries(\n                  Object.entries(u.cost).map(([r, c]) => [\n                    r,\n                    Math.floor((c || 0) * 1.5),\n                  ]),\n                ),\n              }\n            : u,\n        ),\n      );\n    }\n  };\n\n  const getScavengeProgress = (location: MapLocation) => {\n    if (!location.lastScavenged || location.scavengeTime === 0) return 0;\n    const elapsed = Date.now() - location.lastScavenged;\n    return Math.min(100, (elapsed / location.scavengeTime) * 100);\n  };\n\n  const attackLocation = (location: MapLocation) => {\n    const success = Math.random() < 0.7; // Increased to 70% chance of success\n\n    if (success) {\n      const materialsGained = 20 + Math.floor(Math.random() * 30);\n      setResources((prev) => ({\n        ...prev,\n        materials: prev.materials + materialsGained,\n      }));\n      setLocations((prev) =>\n        prev.map((loc) =>\n          loc.id === location.id ? { ...loc, owner: \"player\" } : loc,\n        ),\n      );\n      setShowAttackResult({\n        success: true,\n        locationName: location.name,\n        resourcesGained: { materials: materialsGained },\n      });\n      setShowAttackedAnimation(location.id); // Trigger red square animation\n    } else {\n      const survivorsLost = 1; // Always lose 1 survivor on failure\n      setResources((prev) => ({\n        ...prev,\n        survivors: Math.max(0, prev.survivors - survivorsLost),\n      }));\n      setShowAttackResult({\n        success: false,\n        locationName: location.name,\n        survivorsLost: survivorsLost,\n      });\n    }\n    setShowRadialMenu(false);\n  };\n\n  const buyBackLocation = (location: MapLocation) => {\n    const cost = { materials: 50 }; // Example cost\n\n    const canAfford = Object.entries(cost).every(\n      ([resource, amount]) => resources[resource as keyof Resources] >= (amount || 0)\n    );\n\n    if (canAfford) {\n      setResources(prev => {\n        const newResources = { ...prev };\n        Object.entries(cost).forEach(([resource, amount]) => {\n          newResources[resource as keyof Resources] -= amount || 0;\n        });\n        return newResources;\n      });\n\n      setLocations(prev =>\n        prev.map(loc =>\n          loc.id === location.id ? { ...loc, owner: \"player\" } : loc\n        )\n      );\n      setShowAttackedAnimation(location.id); // Trigger red square animation\n      setShowRadialMenu(false);\n    } else {\n      // Optionally, add feedback for not being able to afford\n      console.log(\"Cannot afford to buy back this location.\");\n    }\n  };\n\n  // Add new state for first time user\n  const [isFirstTimeUser, setIsFirstTimeUser] = useState(() => {\n    const savedGame = localStorage.getItem(SAVE_KEY);\n    return !savedGame;\n  });\n  \n  // Add new state for game over\n  const [isGameOver, setIsGameOver] = useState(false);\n  \n  // Update startNewGame function\n  const startNewGame = () => {\n    setResources(initialResources);\n    setUpgrades(upgrades.map(upgrade => ({ ...upgrade, level: 0 })));\n    setLocations(generateInitialGrid());\n    setBuildings([]);\n    setIsGameOver(false);\n    setIsFirstTimeUser(false);\n    setShowDisaster(null);\n    setShowAttackResult(null);\n    setShowAIAttack(null);\n    setScavengeResult(null);\n    setWaitingForScavengePopup(false);\n    setShowAttackedAnimation(null);\n    setSelectedLocation(null);\n    setShowRadialMenu(false);\n    localStorage.removeItem(SAVE_KEY); // Clear saved game from localStorage\n  };\n\n  // Clear attacked animation after a duration\n  useEffect(() => {\n    if (showAttackedAnimation) {\n      const timer = setTimeout(() => {\n        setShowAttackedAnimation(null);\n      }, 1500); // Animation duration\n      return () => clearTimeout(timer);\n    }\n  }, [showAttackedAnimation]);\n\n  // Update GameOver component\n  const GameOver = () => {\n    if (!isGameOver) return null;\n\n    return (\n      <div className=\"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4 pointer-events-auto\">\n        <div className=\"relative bg-gray-900 border border-red-700 rounded-xl p-8 max-w-md shadow-2xl text-center animate-fade-in\">\n          <h3 className=\"text-4xl font-bold text-red-500 mb-6 drop-shadow-md\">\n            Game Over\n          </h3>\n          <p className=\"text-gray-200 text-lg mb-8\">\n            All your survivors have perished. The wasteland has claimed another settlement.\n          </p>\n          <div className=\"space-y-4\">\n            <button\n              onClick={startNewGame}\n              className=\"w-full px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md bg-gradient-to-r from-green-600 to-green-800 hover:from-green-700 hover:to-green-900 text-white\"\n            >\n              Start New Game\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  // Update NewGame component\n  const NewGame = () => {\n    if (!isFirstTimeUser) return null;\n\n    return (\n      <div className=\"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4 pointer-events-auto\">\n        <div className=\"relative bg-gray-900 border border-blue-700 rounded-xl p-8 max-w-md shadow-2xl text-center animate-fade-in\">\n          <h3 className=\"text-4xl font-bold text-blue-500 mb-6 drop-shadow-md\">\n            Welcome to Wasteland Survivor\n          </h3>\n          <p className=\"text-gray-200 text-lg mb-8\">\n            Lead your survivors through the post-apocalyptic wasteland. Gather resources, expand your territory, and survive against all odds.\n          </p>\n          <div className=\"space-y-4\">\n            <button\n              onClick={startNewGame}\n              className=\"w-full px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-700 hover:to-blue-900 text-white\"\n            >\n              Start New Game\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  // Update popup components to remove pointer-events-none\n  const ScavengePopup = () => {\n    if (!scavengeResult) return null;\n\n    return (\n      <div className=\"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4\">\n        <div className=\"relative bg-gray-900 border border-gray-700 rounded-xl p-8 max-w-sm shadow-2xl text-center animate-fade-in\">\n          <h3 className=\"text-3xl font-bold text-green-500 mb-4 drop-shadow-md\">\n            Resources Found!\n          </h3>\n          <ul className=\"text-gray-200 text-lg space-y-2 mb-6\">\n            {Object.entries(scavengeResult).map(([key, value]) =>\n              value > 0 ? (\n                <li key={key} className=\"flex items-center justify-center\">\n                  <span className=\"capitalize mr-2\">{key}:</span>\n                  <span className=\"font-semibold text-white text-2xl\">{value}</span>\n                </li>\n              ) : null,\n            )}\n          </ul>\n          <button\n            onClick={() => {\n              setScavengeResult(null);\n              setWaitingForScavengePopup(false); // Enables next scavenge\n            }}\n            className=\"w-full px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md bg-gradient-to-r from-green-600 to-green-800 hover:from-green-700 hover:to-green-900 text-white\"\n          >\n            Continue\n          </button>\n        </div>\n      </div>\n    );\n  };\n\n  const DisasterPopup = () => {\n    if (!showDisaster) return null;\n\n    return (\n      <div className=\"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4\">\n        <div className=\"relative bg-gray-900 border border-red-700 rounded-xl p-8 max-w-sm shadow-2xl text-center animate-fade-in\">\n          <h3 className=\"text-3xl font-bold text-red-500 mb-4 drop-shadow-md\">\n            {showDisaster.name}\n          </h3>\n          <p className=\"text-gray-200 text-lg mb-6\">{showDisaster.description}</p>\n          <div className=\"text-lg text-gray-300 space-y-2 mb-6\">\n            {Object.entries(showDisaster.effect).map(([resource, amount]) => (\n              <p key={resource} className=\"flex items-center justify-center\">\n                <span className=\"capitalize mr-2\">{resource}:</span>\n                <span className=\"font-semibold text-white text-2xl\">{amount}</span>\n              </p>\n            ))}\n          </div>\n          <button\n            onClick={() => setShowDisaster(null)}\n            className=\"w-full px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md bg-gradient-to-r from-red-600 to-red-800 hover:from-red-700 hover:to-red-900 text-white\"\n          >\n            Continue\n          </button>\n        </div>\n      </div>\n    );\n  };\n\n  const AttackResultPopup = () => {\n    if (!showAttackResult) return null;\n\n    const isSuccess = showAttackResult.success;\n\n    return (\n      <div className=\"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4\">\n        <div className={`relative bg-gray-900 border ${isSuccess ? \"border-green-700\" : \"border-red-700\"} rounded-xl p-8 max-w-sm shadow-2xl text-center animate-fade-in`}>\n          <h3 className={`text-3xl font-bold ${isSuccess ? \"text-green-500\" : \"text-red-500\"} mb-4 drop-shadow-md`}>\n            {isSuccess ? \"Attack Successful!\" : \"Attack Failed!\"}\n          </h3>\n          <p className=\"text-gray-200 text-lg mb-6\">\n            {isSuccess ? (\n              <>\n                You successfully took over the <span className=\"font-semibold\">{showAttackResult.locationName}</span>! You gained:\n              </>\n            ) : (\n              <>\n                Your attack on <span className=\"font-semibold\">{showAttackResult.locationName}</span> failed! You lost:\n              </>\n            )}\n          </p>\n          <ul className=\"text-gray-200 text-lg space-y-2 mb-6\">\n            {isSuccess && showAttackResult.resourcesGained ? (\n              Object.entries(showAttackResult.resourcesGained).map(([key, value]) =>\n                value && value > 0 ? (\n                  <li key={key} className=\"flex items-center justify-center\">\n                    <span className=\"capitalize mr-2\">{key}:</span>\n                    <span className=\"font-semibold text-white text-2xl\">{value}</span>\n                  </li>\n                ) : null,\n              )\n            ) : null}\n            {!isSuccess && showAttackResult.survivorsLost ? (\n              <li className=\"flex items-center justify-center\">\n                <span className=\"capitalize mr-2\">Survivors:</span>\n                <span className=\"font-semibold text-white text-2xl\">{showAttackResult.survivorsLost}</span>\n              </li>\n            ) : null}\n          </ul>\n          <button\n            onClick={() => setShowAttackResult(null)}\n            className={`w-full px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md ${isSuccess\n              ? \"bg-gradient-to-r from-green-600 to-green-800 hover:from-green-700 hover:to-green-900 text-white\"\n              : \"bg-gradient-to-r from-red-600 to-red-800 hover:from-red-700 hover:to-red-900 text-white\"}\n            `}\n          >\n            Continue\n          </button>\n        </div>\n      </div>\n    );\n  };\n\n  const AIAttackPopup = () => {\n    if (!showAIAttack) return null;\n\n    const isSuccess = showAIAttack.success;\n\n    return (\n      <div className=\"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4\">\n        <div className={`relative bg-gray-900 border ${isSuccess ? \"border-green-700\" : \"border-red-700\"} rounded-xl p-8 max-w-sm shadow-2xl text-center animate-fade-in`}>\n          <h3 className={`text-3xl font-bold ${isSuccess ? \"text-green-500\" : \"text-red-500\"} mb-4 drop-shadow-md`}>\n            {isSuccess ? \"Rival Clan Attack Successful!\" : \"Rival Clan Attack Failed!\"}\n          </h3>\n          <p className=\"text-gray-200 text-lg mb-6\">\n            {isSuccess ? (\n              <>\n                AI successfully took over the <span className=\"font-semibold\">{showAIAttack.locationName}</span>! You lost:\n              </>\n            ) : (\n              <>\n                AI attack on <span className=\"font-semibold\">{showAIAttack.locationName}</span> failed! You lost:\n              </>\n            )}\n          </p>\n          <ul className=\"text-gray-200 text-lg space-y-2 mb-6\">\n            {isSuccess && showAIAttack.survivorsLost ? (\n              <li className=\"flex items-center justify-center\">\n                <span className=\"capitalize mr-2\">Survivors:</span>\n                <span className=\"font-semibold text-white text-2xl\">{showAIAttack.survivorsLost}</span>\n              </li>\n            ) : null}\n          </ul>\n          <button\n            onClick={() => setShowAIAttack(null)}\n            className={`w-full px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md ${isSuccess\n              ? \"bg-gradient-to-r from-green-600 to-green-800 hover:from-green-700 hover:to-green-900 text-white\"\n              : \"bg-gradient-to-r from-red-600 to-red-800 hover:from-red-700 hover:to-red-900 text-white\"}\n            `}\n          >\n            Continue\n          </button>\n        </div>\n      </div>\n    );\n  };\n\n  // Update MapView to use built-in animation\n  const MapView = ({\n    buildings,\n    availableBuildings,\n    setBuildings,\n    setResources,\n    locations,\n    showAttackedAnimation,\n  }: {\n    buildings: Building[];\n    availableBuildings: Building[];\n    setBuildings: React.Dispatch<React.SetStateAction<Building[]>>;\n    setResources: React.Dispatch<React.SetStateAction<Resources>>;\n    locations: MapLocation[];\n    showAttackedAnimation: string | null;\n  }) => {\n    const handleDragOver = (e: React.DragEvent) => {\n      e.preventDefault(); // Allow dropping\n    };\n\n    const handleDrop = (e: React.DragEvent, locationId: string) => {\n      e.preventDefault();\n      const buildingId = e.dataTransfer.getData(\"buildingId\");\n      const buildingBlueprint = availableBuildings.find((b) => b.id === buildingId);\n      const targetLocation = locations.find((loc) => loc.id === locationId);\n\n      if (!buildingBlueprint || !targetLocation) return;\n\n      // Check if location is valid for building (player-owned, not base, no existing building)\n      const isLocationOccupied = buildings.some(b => b.locationId === locationId);\n      if (!targetLocation.discovered || targetLocation.owner !== \"player\" || targetLocation.isBase || isLocationOccupied) {\n        console.log(\"Cannot place building here.\");\n        return;\n      }\n\n      // Check if player can afford the building\n      const canAfford = Object.entries(buildingBlueprint.cost).every(\n        ([resource, cost]) => resources[resource as keyof Resources] >= (cost || 0)\n      );\n\n      if (!canAfford) {\n        console.log(\"Cannot afford this building.\");\n        return;\n      }\n\n      // Deduct resources\n      setResources(prev => {\n        const newResources = { ...prev };\n        Object.entries(buildingBlueprint.cost).forEach(([resource, cost]) => {\n          newResources[resource as keyof Resources] -= cost || 0;\n        });\n        return newResources;\n      });\n\n      // Add building to state\n      const newBuilding: Building = {\n        ...buildingBlueprint,\n        id: `${buildingBlueprint.type}-${Date.now()}`, // Unique ID for placed building\n        locationId: locationId,\n      };\n      setBuildings(prev => [...prev, newBuilding]);\n    };\n\n    return (\n      <div className=\"relative bg-gray-900 border border-gray-700 rounded-xl p-8 shadow-2xl h-full flex flex-col overflow-hidden before:absolute before:inset-0 before:bg-gradient-to-br before:from-gray-800 before:via-gray-900 before:to-black before:opacity-50 before:rounded-xl\">\n        <h2 className=\"relative z-10 text-4xl font-extrabold text-white mb-8 text-center drop-shadow-md font-display\">\n          Wasteland Map\n        </h2>\n        <div\n          className=\"relative z-10 grid bg-gray-950 border border-gray-700 rounded-lg aspect-square shadow-inner overflow-hidden\"\n          style={{\n            gridTemplateColumns: `repeat(${GRID_SIZE}, 1fr)`,\n            gridTemplateRows: `repeat(${GRID_SIZE}, 1fr)`,\n          }}\n          onClick={() => setShowRadialMenu(false)}\n        >\n          {locations.map((location) => {\n            const isAnimatingTakeover = showAttackedAnimation === location.id;\n            const placedBuilding = buildings.find(b => b.locationId === location.id);\n\n            return (\n              <div\n                key={location.id}\n                className={`relative flex items-center justify-center p-1 transition-all duration-300 group ${location.discovered ? \"cursor-pointer\" : \"opacity-30\"} ${isAnimatingTakeover ? 'animate-pulse' : ''} ${location.id === showAttackedAnimation ? 'border-4 border-red-500 animate-pulse-fast' : ''}`}\n                onClick={(e) => handleMapClick(e, location)}\n                onDragOver={handleDragOver} // Enable drag over\n                onDrop={(e) => handleDrop(e, location.id)} // Handle drop\n              >\n                {location.discovered ? (\n                  <div className=\"relative w-full h-full flex flex-col items-center justify-center text-center rounded-md overflow-hidden shadow-md group-hover:shadow-lg transition-shadow duration-300 border-2 border-transparent group-hover:border-blue-500\">\n                    <div\n                      className={`w-full h-full flex items-center justify-center text-4xl transform transition-all duration-300 group-hover:scale-105 ${location.isBase || location.owner === \"player\" ? \"bg-green-700\" : \"bg-blue-700\"}`}\n                    >\n                      {placedBuilding ? (\n                        placedBuilding.imageUrl ? (\n                          <img src={placedBuilding.imageUrl} alt={placedBuilding.name} className=\"w-10 h-10 object-contain mx-auto\" />\n                        ) : (\n                          <BaseIcon />\n                        )\n                      ) : (\n                        location.isBase ? (\n                          <BaseIcon />\n                        ) : location.owner === \"player\" ? (\n                          <ResourcesIcon />\n                        ) : location.resources && Object.values(location.resources).some(val => val && val > 0) ? (\n                          <ResourcesIcon />\n                        ) : null\n                      )}\n                    </div>\n                    <div className=\"absolute bottom-0 left-0 right-0 bg-gray-800 bg-opacity-80 p-1 text-center backdrop-blur-sm group-hover:bg-opacity-90 transition-opacity\">\n                      <p className=\"text-xs font-semibold text-gray-200 truncate font-display\">\n                        {location.name}\n                      </p>\n                    </div>\n                    {location.lastScavenged && location.scavengeTime > 0 && (\n                      <div className=\"absolute top-0 left-0 right-0 h-1 bg-gray-700 rounded-t\">\n                        <div\n                          className=\"h-full bg-yellow-500 rounded-t transition-all duration-1000\"\n                          style={{ width: `${getScavengeProgress(location)}%` }}\n                        />\n                      </div>\n                    )}\n                  </div>\n                ) : (\n                  <div className=\"w-full h-full rounded-md bg-gray-800 flex items-center justify-center text-4xl opacity-50 animate-pulse border border-gray-700\"></div>\n                )}\n              </div>\n            );\n          })}\n        </div>\n      </div>\n    );\n  };\n\n  // Components\n  const ResourcePanel = React.memo(\n    ({\n      resources,\n      upgrades,\n      autoScavengeEnabled,\n      purchaseUpgrade,\n      setAutoScavengeEnabled,\n      availableBuildings,\n    }: {\n      resources: Resources;\n      upgrades: BaseUpgrade[];\n      autoScavengeEnabled: boolean;\n      purchaseUpgrade: (upgrade: BaseUpgrade) => void;\n      setAutoScavengeEnabled: (enabled: boolean) => void;\n      availableBuildings: Building[];\n    }) => {\n      const onDragStart = (e: React.DragEvent, buildingId: string) => {\n        e.dataTransfer.setData(\"buildingId\", buildingId);\n      };\n\n      return (\n        <div className=\"relative bg-gray-900 border border-gray-700 rounded-xl p-8 shadow-2xl h-full flex flex-col overflow-hidden before:absolute before:inset-0 before:bg-gradient-to-br before:from-gray-800 before:via-gray-900 before:to-black before:opacity-50 before:rounded-xl\">\n          <div className=\"relative z-10 flex-none\">\n            <h2 className=\"text-4xl font-extrabold text-white mb-8 text-center drop-shadow-md font-display\">\n              Resources\n            </h2>\n            <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-6 mb-10\">\n              <div className=\"relative bg-gray-800 bg-opacity-70 backdrop-filter backdrop-blur-sm rounded-lg p-5 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-700 flex flex-col items-center justify-center space-y-2\">\n                <FoodIcon />\n                <span className=\"text-lg font-bold text-gray-100 font-display\">Food</span>\n                <span className=\"text-3xl font-semibold text-green-400 font-mono\">\n                  {Math.floor(resources.food)}\n                </span>\n              </div>\n              <div className=\"relative bg-gray-800 bg-opacity-70 backdrop-filter backdrop-blur-sm rounded-lg p-5 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-700 flex flex-col items-center justify-center space-y-2\">\n                <WaterIcon />\n                <span className=\"text-lg font-bold text-gray-100 font-display\">Water</span>\n                <span className=\"text-3xl font-semibold text-blue-400 font-mono\">\n                  {Math.floor(resources.water)}\n                </span>\n              </div>\n              <div className=\"relative bg-gray-800 bg-opacity-70 backdrop-filter backdrop-blur-sm rounded-lg p-5 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-700 flex flex-col items-center justify-center space-y-2\">\n                <MaterialsIcon />\n                <span className=\"text-lg font-bold text-gray-100 font-display\">Materials</span>\n                <span className=\"text-3xl font-semibold text-orange-400 font-mono\">\n                  {Math.floor(resources.materials)}\n                </span>\n              </div>\n              <div className=\"relative bg-gray-800 bg-opacity-70 backdrop-filter backdrop-blur-sm rounded-lg p-5 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-700 flex flex-col items-center justify-center space-y-2\">\n                <SurvivorsIcon />\n                <span className=\"text-lg font-bold text-gray-100 font-display\">Survivors</span>\n                <span className=\"text-3xl font-semibold text-purple-400 font-mono\">\n                  {resources.survivors}\n                </span>\n              </div>\n            </div>\n            <h3 className=\"text-3xl font-bold text-white mb-6 text-center drop-shadow-md\">\n              Base Upgrades\n            </h3>\n          </div>\n\n          <div className=\"relative z-10 flex-grow overflow-y-auto pr-4 -mr-4\"> {/* Added pr-4 -mr-4 for scrollbar */}\n            <div className=\"space-y-4\">\n              {upgrades.map((upgrade) => {\n                const canAfford = Object.entries(upgrade.cost).every(\n                  ([resource, cost]) =>\n                    resources[resource as keyof Resources] >= (cost || 0),\n                );\n\n                return (\n                  <div\n                    key={upgrade.id}\n                    className=\"bg-gray-800 bg-opacity-60 backdrop-filter backdrop-blur-sm rounded-xl p-5 shadow-lg flex flex-col md:flex-row items-center gap-4 border border-gray-700 hover:shadow-xl transition-shadow\"\n                  >\n                    <div className=\"flex-grow text-center md:text-left\">\n                      <div className=\"flex flex-col md:flex-row items-center gap-2 mb-1\">\n                        <h4 className=\"text-xl font-semibold text-white\">\n                          {upgrade.name}\n                        </h4>\n                        <p className=\"text-sm text-green-300\">\n                          {upgrade.effect}\n                        </p>\n                      </div>\n                      <p className=\"text-sm text-gray-300 mb-2\">\n                        {upgrade.description}\n                      </p>\n                      <p className=\"text-md font-medium text-gray-200\">\n                        Level {upgrade.level}/{upgrade.maxLevel}\n                      </p>\n                    </div>\n                    {upgrade.level < upgrade.maxLevel && (\n                      <button\n                        onClick={() => purchaseUpgrade(upgrade)}\n                        disabled={!canAfford}\n                        className={`w-full md:w-auto px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md ${\n                          canAfford\n                            ? \"bg-gradient-to-r from-green-600 to-green-800 hover:from-green-700 hover:to-green-900 text-white\"\n                            : \"bg-gray-600 text-gray-400 cursor-not-allowed opacity-70\"\n                        }`}\n                      >\n                        <p>Upgrade</p>\n                        <p className=\"text-xs mt-1 opacity-80\">\n                          (\n                          {Object.entries(upgrade.cost)\n                            .map(([r, c]) => `${c} ${r}`)\n                            .join(\", \")}\n                          )\n                        </p>\n                      </button>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n\n            <h3 className=\"text-3xl font-bold text-white mt-10 mb-6 text-center drop-shadow-md\">\n              Available Buildings\n            </h3>\n            <div className=\"grid grid-cols-2 gap-4\">\n              {availableBuildings.map((building) => {\n                const canAffordBuilding = Object.entries(building.cost).every(\n                  ([resource, cost]) => resources[resource as keyof Resources] >= (cost || 0)\n                );\n                return (\n                  <div\n                    key={building.id}\n                    draggable\n                    onDragStart={(e) => onDragStart(e, building.id)}\n                    className={`bg-gray-800 bg-opacity-60 backdrop-filter backdrop-blur-sm rounded-xl p-4 shadow-lg flex flex-col items-center text-center border border-gray-700 transition-all duration-300\n                      ${canAffordBuilding ? \"cursor-grab active:cursor-grabbing hover:shadow-xl\" : \"opacity-50 cursor-not-allowed\"}\n                    `}\n                  >\n                    {building.imageUrl ? (\n                      <img src={building.imageUrl} alt={building.name} className=\"w-16 h-16 object-cover mb-2\" />\n                    ) : (\n                      <span className=\"text-4xl mb-2\"></span>\n                    )}\n                    <h4 className=\"text-xl font-semibold text-white mb-1\">{building.name}</h4>\n                    <p className=\"text-sm text-gray-300 mb-2\">\n                      Cost: {Object.entries(building.cost).map(([r, c]) => `${c} ${r}`).join(\", \")}\n                    </p>\n                    {!canAffordBuilding && (\n                      <p className=\"text-red-400 text-xs\">Cannot afford</p>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n\n          <div className=\"relative z-10 flex-none mt-8 pt-6 border-t border-gray-700\">\n            <label className=\"flex items-center justify-center space-x-3 text-gray-300 cursor-pointer\">\n              <input\n                type=\"checkbox\"\n                checked={autoScavengeEnabled}\n                onChange={(e) => setAutoScavengeEnabled(e.target.checked)}\n                className=\"form-checkbox h-5 w-5 text-green-500 bg-gray-700 border-gray-600 rounded focus:ring-green-500\"\n              />\n              <span className=\"text-lg font-medium text-white\">Auto-scavenge locations</span>\n            </label>\n          </div>\n          <div className=\"relative z-10 flex-none mt-8 pt-6 border-t border-gray-700\">\n            <button\n              onClick={startNewGame}\n              className=\"w-full px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md bg-gradient-to-r from-red-600 to-red-800 hover:from-red-700 hover:to-red-900 text-white\"\n            >\n              Reset Game\n            </button>\n          </div>\n        </div>\n      );\n    },\n  );\n\n  // Components\n  const RadialMenu = () => {\n    if (!showRadialMenu || !selectedLocation) return null;\n\n    const actions: RadialMenuAction[] = [\n      {\n        label: \"Scavenge\",\n        icon: <ResourcesIcon />,\n        enabled:\n          !selectedLocation.lastScavenged &&\n          selectedLocation.scavengeTime > 0 &&\n          Object.values(selectedLocation.resources).some(\n            (val) => val && val > 0,\n          ),\n        action: () => scavengeLocation(selectedLocation),\n      },\n      {\n        label: \"Attack\",\n        icon: <AttackIcon />,\n        enabled: \n          selectedLocation.discovered && \n          !selectedLocation.isBase &&\n          selectedLocation.owner !== \"player\",\n        action: () => attackLocation(selectedLocation),\n      },\n      {\n        label: \"Buy Back\",\n        icon: \"\",\n        enabled:\n          selectedLocation.discovered &&\n          !selectedLocation.isBase &&\n          selectedLocation.owner !== \"player\" &&\n          resources.materials >= 50,\n        action: () => buyBackLocation(selectedLocation),\n        cost: { materials: 50 },\n      },\n      {\n        label: \"Explore\",\n        icon: <ExploreIcon />,\n        enabled: resources.materials >= EXPLORATION_COST.materials && resources.survivors >= EXPLORATION_COST.survivors,\n        action: exploreNearby,\n        cost: EXPLORATION_COST,\n      },\n      {\n        label: \"Cancel\",\n        icon: <CancelIcon />,\n        enabled: true,\n        action: () => setShowRadialMenu(false),\n      },\n    ];\n\n    return (\n      <div\n        className=\"absolute\"\n        style={{ left: radialMenuPosition.x, top: radialMenuPosition.y }}\n      >\n        {actions.map((action, index) => {\n          const angle = (index * 120 - 60) * (Math.PI / 180);\n          const x = Math.cos(angle) * 100;\n          const y = Math.sin(angle) * 100;\n\n          return (\n            <button\n              key={action.label}\n              disabled={!action.enabled}\n              onClick={(e) => {\n                e.stopPropagation();\n                action.action();\n              }}\n              className={`absolute transform -translate-x-1/2 -translate-y-1/2 w-24 h-24 rounded-full flex flex-col items-center justify-center text-white text-sm font-bold uppercase tracking-wider transition-all duration-300 shadow-xl border-2 ${\n                action.enabled\n                  ? \"bg-gradient-to-br from-blue-600 to-blue-800 hover:from-blue-700 hover:to-blue-900 border-blue-500 hover:border-blue-300 transform hover:scale-110\"\n                  : \"bg-gray-700 border-gray-600 cursor-not-allowed opacity-60\"\n              }`}\n              style={{ left: x, top: y }}\n            >\n              <div className=\"text-3xl mb-1\">{action.icon}</div>\n              <span className=\"font-display\">{action.label}</span>\n              {action.cost && (\n                <div className=\"text-xs mt-1 text-gray-300\">\n                  {action.cost.materials !== undefined && (\n                    <div className=\"flex items-center justify-center\">\n                      <span className=\"mr-1\">\n                        <MaterialsIcon className=\"h-4 w-4\" />\n                      </span>\n                      <span className=\"font-mono\">{action.cost.materials}</span>\n                    </div>\n                  )}\n                  {action.cost.survivors !== undefined && (\n                    <div className=\"flex items-center justify-center\">\n                      <span className=\"mr-1\">\n                        <SurvivorsIcon className=\"h-4 w-4\" />\n                      </span>\n                      <span className=\"font-mono\">{action.cost.survivors}</span>\n                    </div>\n                  )}\n                </div>\n              )}\n            </button>\n          );\n        })}\n      </div>\n    );\n  };\n\n  // Add game over check to the game loop\n  useEffect(() => {\n    if (resources.survivors <= 0 && !isGameOver) {\n      setIsGameOver(true);\n    }\n  }, [resources.survivors, isGameOver]);\n\n  // Add back the triggerAIAttack function\n  const triggerAIAttack = () => {\n    const playerOwnedLocations = locations.filter(\n      (loc) => loc.owner === \"player\" && !loc.isBase\n    );\n\n    if (playerOwnedLocations.length > 0) {\n      const targetLocation =\n        playerOwnedLocations[Math.floor(Math.random() * playerOwnedLocations.length)];\n      const success = Math.random() < 0.75; // Increased AI attack success chance\n\n      setShowAttackedAnimation(targetLocation.id); // Trigger red square animation\n\n      if (success) {\n        // AI takes over the location\n        setLocations((prev) =>\n          prev.map((loc) =>\n            loc.id === targetLocation.id ? { ...loc, owner: null } : loc\n          )\n        );\n        setResources((prev) => ({\n          ...prev,\n          survivors: Math.max(0, prev.survivors - 1),\n        }));\n        setShowAIAttack({\n          locationId: targetLocation.id,\n          locationName: targetLocation.name,\n          success: true,\n          survivorsLost: 1,\n        });\n      } else {\n        // Player successfully defended\n        setShowAIAttack({\n          locationId: targetLocation.id,\n          locationName: targetLocation.name,\n          success: false,\n        });\n      }\n    }\n  };\n\n  // HowToPlay component\n  const HowToPlay = () => {\n    if (!showHowToPlay) return null;\n\n    return (\n      <div className=\"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 p-4 pointer-events-auto\">\n        <div className=\"relative bg-gray-900 border border-blue-700 rounded-xl p-8 max-w-2xl shadow-2xl text-center animate-fade-in\">\n          <h3 className=\"text-4xl font-bold text-blue-500 mb-6 drop-shadow-md font-display\">\n            How to Play\n          </h3>\n          <div className=\"text-gray-200 text-lg space-y-4 text-left\">\n            <p>\n              Welcome to Wasteland Survivor! Your goal is to lead your group of survivors through a post-apocalyptic world. Here's how to play:\n            </p>\n            <h4 className=\"text-xl font-semibold text-blue-300 mt-4\">Resources:</h4>\n            <p>Gather Food , Water , Materials , and manage your Survivors . These are essential for survival and progress.</p>\n\n            <h4 className=\"text-xl font-semibold text-blue-300 mt-4\">Map & Exploration:</h4>\n            <p>Click on map locations to open a radial menu. You can Scavenge locations for resources, Attack rival locations to take them over, or Explore nearby to discover new areas. Exploring costs materials and survivors.</p>\n\n            <h4 className=\"text-xl font-semibold text-blue-300 mt-4\">Buildings:</h4>\n            <p>From the Resources panel, you can drag and drop buildings like Houses onto available map squares. Houses provide shelter for your survivors; without enough housing, survivors will freeze and die!</p>\n\n            <h4 className=\"text-xl font-semibold text-blue-300 mt-4\">Upgrades:</h4>\n            <p>Invest in base upgrades to increase your resource production and survivor attraction.</p>\n\n            <h4 className=\"text-xl font-semibold text-blue-300 mt-4\">Threats:</h4>\n            <p>Beware of random Disasters and Rival Clan attacks. These events can deplete your resources and survivors, so be prepared!</p>\n\n            <h4 className=\"text-xl font-semibold text-blue-300 mt-4\">Game Over:</h4>\n            <p>The game ends if all your survivors are lost. You can always start a new game to try again!</p>\n          </div>\n          <button\n            onClick={() => setShowHowToPlay(false)}\n            className=\"w-full mt-8 px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md bg-gradient-to-r from-blue-600 to-blue-800 hover:from-blue-700 hover:to-blue-900 text-white\"\n          >\n            Got It!\n          </button>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-950 text-white font-sans antialiased relative overflow-hidden\">\n      {/* Background overlay */}\n      <div \n        className=\"fixed inset-0 z-0 opacity-10 pointer-events-none\" \n        style={{ \n          backgroundImage: `url('https://www.transparenttextures.com/patterns/dust-and-stones.png')`, \n          backgroundSize: 'cover',\n          backgroundAttachment: 'fixed'\n        }}\n      ></div>\n      \n      {!isGameOver && (\n        <>\n          {isMobile ? (\n            // Mobile layout with tabs\n            <div className=\"relative z-10 px-4 py-6 h-screen flex flex-col bg-gray-950 bg-opacity-95 pointer-events-auto\">\n              <h1 className=\"text-5xl font-extrabold text-center mb-8 text-white drop-shadow-lg leading-tight font-display\">\n                Wasteland\n                <br />\n                Survivor\n              </h1>\n              <div className=\"flex mb-6 bg-gray-800 rounded-xl p-1 shadow-inner border border-gray-700\">\n                <button\n                  onClick={() => setActiveTab(\"resources\")}\n                  className={`flex-1 py-3 px-4 rounded-lg text-lg font-bold transition-all duration-300 transform hover:scale-105 shadow-md ${\n                    activeTab === \"resources\"\n                      ? \"bg-gradient-to-r from-blue-600 to-blue-800 text-white\" : \"text-gray-400 hover:text-white hover:bg-gray-700\"\n                  }`}\n                >\n                  Resources\n                </button>\n                <button\n                  onClick={() => setActiveTab(\"map\")}\n                  className={`flex-1 py-3 px-4 rounded-lg text-lg font-bold transition-all duration-300 transform hover:scale-105 shadow-md ${\n                    activeTab === \"map\"\n                      ? \"bg-gradient-to-r from-blue-600 to-blue-800 text-white\" : \"text-gray-400 hover:text-white hover:bg-gray-700\"\n                  }`}\n                >\n                  Map\n                </button>\n              </div>\n              {activeTab === \"resources\" ? (\n                <ResourcePanel\n                  resources={resources}\n                  upgrades={upgrades}\n                  autoScavengeEnabled={autoScavengeEnabled}\n                  purchaseUpgrade={purchaseUpgrade}\n                  setAutoScavengeEnabled={setAutoScavengeEnabled}\n                  availableBuildings={availableBuildings}\n                />\n              ) : (\n                <MapView\n                  buildings={buildings}\n                  availableBuildings={availableBuildings}\n                  setBuildings={setBuildings}\n                  setResources={setResources}\n                  locations={locations}\n                  showAttackedAnimation={showAttackedAnimation}\n                />\n              )}\n            </div>\n          ) : (\n            // Desktop split-screen layout\n            <div className=\"relative z-10 flex h-screen p-8 gap-8 bg-gray-950 bg-opacity-95\">\n              <div className=\"w-1/2 flex flex-col\">\n                <h1 className=\"text-5xl font-extrabold mb-8 text-white drop-shadow-lg leading-tight text-center font-display\">\n                  Wasteland\n                  <br />\n                  Survivor\n                </h1>\n                <ResourcePanel\n                  resources={resources}\n                  upgrades={upgrades}\n                  autoScavengeEnabled={autoScavengeEnabled}\n                  purchaseUpgrade={purchaseUpgrade}\n                  setAutoScavengeEnabled={setAutoScavengeEnabled}\n                  availableBuildings={availableBuildings}\n                />\n              </div>\n              <div className=\"w-1/2 flex flex-col h-full\">\n                <MapView\n                  buildings={buildings}\n                  availableBuildings={availableBuildings}\n                  setBuildings={setBuildings}\n                  setResources={setResources}\n                  locations={locations}\n                  showAttackedAnimation={showAttackedAnimation}\n                />\n              </div>\n            </div>\n          )}\n        </>\n      )}\n\n      {/* Global How to Play button */}\n      {!isGameOver && !isFirstTimeUser && (\n        <button\n          onClick={() => setShowHowToPlay(true)}\n          className=\"fixed bottom-4 right-4 px-6 py-3 rounded-lg text-lg font-bold uppercase tracking-wider transition-all duration-300 transform hover:scale-105 shadow-md bg-gradient-to-r from-purple-600 to-purple-800 hover:from-purple-700 hover:to-purple-900 text-white z-40\"\n        >\n          How to Play\n        </button>\n      )}\n\n      {/* Conditionally render the popup container */}\n      {(showRadialMenu || showDisaster || scavengeResult || showAttackResult || showAIAttack || isGameOver || isFirstTimeUser || showHowToPlay) && (\n        <div \n          className=\"fixed inset-0 z-50 bg-black bg-opacity-70 flex items-center justify-center pointer-events-auto\" \n          onClick={(e) => { \n            if (e.target === e.currentTarget) { // Only close if clicking the backdrop, not content\n              setShowRadialMenu(false);\n              setShowDisaster(null);\n              setScavengeResult(null);\n              setShowAttackResult(null);\n              setShowAIAttack(null);\n              setShowHowToPlay(false);\n            }\n          }}\n        >\n          <RadialMenu />\n          <DisasterPopup />\n          <ScavengePopup />\n          <AttackResultPopup />\n          <AIAttackPopup />\n          <GameOver />\n          <NewGame />\n          <HowToPlay />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ApocalypticGame;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}